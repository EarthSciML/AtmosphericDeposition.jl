<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Luo &amp; Yu (2023) · AtmosphericDeposition.jl</title><meta name="title" content="Luo &amp; Yu (2023) · AtmosphericDeposition.jl"/><meta property="og:title" content="Luo &amp; Yu (2023) · AtmosphericDeposition.jl"/><meta property="twitter:title" content="Luo &amp; Yu (2023) · AtmosphericDeposition.jl"/><meta name="description" content="Documentation for AtmosphericDeposition.jl."/><meta property="og:description" content="Documentation for AtmosphericDeposition.jl."/><meta property="twitter:description" content="Documentation for AtmosphericDeposition.jl."/><meta property="og:url" content="https://deposition.earthsci.dev/luo2023/"/><meta property="twitter:url" content="https://deposition.earthsci.dev/luo2023/"/><link rel="canonical" href="https://deposition.earthsci.dev/luo2023/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AtmosphericDeposition.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Dry Deposition</span><ul><li><a class="tocitem" href="../dry_deposition/">Overview</a></li><li><a class="tocitem" href="../wesley1989/">Wesley</a></li><li><a class="tocitem" href="../seinfeld_pandis_ch19/">Seinfeld &amp; Pandis Ch. 19</a></li></ul></li><li><span class="tocitem">Wet Deposition</span><ul><li><a class="tocitem" href="../emep/">EMEP</a></li><li><a class="tocitem" href="../seinfeld_pandis_2006_ch20/">Seinfeld &amp; Pandis (2006) Ch. 20</a></li><li class="is-active"><a class="tocitem" href>Luo &amp; Yu (2023)</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Wet Deposition</a></li><li class="is-active"><a href>Luo &amp; Yu (2023)</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Luo &amp; Yu (2023)</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/main/docs/src/luo2023.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Air-Refreshing-and-Cloud-Ice-Uptake-Limitations-(Luo-and-Yu,-2023)"><a class="docs-heading-anchor" href="#Air-Refreshing-and-Cloud-Ice-Uptake-Limitations-(Luo-and-Yu,-2023)">Air Refreshing and Cloud Ice Uptake Limitations (Luo &amp; Yu, 2023)</a><a id="Air-Refreshing-and-Cloud-Ice-Uptake-Limitations-(Luo-and-Yu,-2023)-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Refreshing-and-Cloud-Ice-Uptake-Limitations-(Luo-and-Yu,-2023)" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>This module implements novel parameterizations for air refreshing limitation and cloud ice uptake limitation on wet scavenging, as described by Luo and Yu (2023). These parameterizations address two key unresolved processes in global atmospheric models:</p><ol><li><p><strong>Air refreshing limitation</strong> (Section 2.1): Accounts for the finite time needed for species in subgrid cloud-free (rain-free) air to be transported and mixed into cloudy (rainy) air before being subject to wet scavenging. The standard well-mixed assumption overestimates wet scavenging when the subgrid air mixing time scale is comparable to the model time step.</p></li><li><p><strong>Cloud ice uptake limitation</strong> (Section 2.2): Limits cold cloud rainout efficiency by the rate at which interstitial water-soluble aerosols are captured by ice crystals via coagulation. The original GEOS-Chem assumption of 100% rainout efficiency for cold clouds is replaced by a physically-based efficiency that depends on ice crystal properties and temperature.</p></li></ol><p><strong>Reference</strong>: Luo, G., &amp; Yu, F. (2023). Impact of air refreshing and cloud ice uptake limitations on vertical profiles and wet depositions of nitrate, ammonium, and sulfate. <em>Geophysical Research Letters</em>, 50, e2023GL104258. <a href="https://doi.org/10.1029/2023GL104258">https://doi.org/10.1029/2023GL104258</a></p><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.AirRefreshingLimitation"><a class="docstring-binding" href="#AtmosphericDeposition.AirRefreshingLimitation"><code>AtmosphericDeposition.AirRefreshingLimitation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AirRefreshingLimitation(; name = :AirRefreshingLimitation)</code></pre><p>ModelingToolkit component implementing the air refreshing limitation on wet scavenging from Luo &amp; Yu (2023), Eqs. 2, 5, 10, 11.</p><p>This parameterization accounts for the fact that species in subgrid cloud-free (rain-free) air need time to be mixed with those in cloudy (rainy) air before being influenced by wet scavenging. The standard well-mixed assumption can overestimate wet scavenging when the subgrid air mixing time scale is comparable to the model time step.</p><p>The air refreshing limited removal rate <code>R_A</code> replaces the standard <code>f·Rᵢ</code> in wet scavenging calculations. When turbulent mixing is strong (large TKE), <code>R_A ≈ f·Rᵢ</code>; when mixing is weak, <code>R_A &lt; f·Rᵢ</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/de0e7268e39c3dff93d6da69a3d9d4786c8bc3df/src/luo2023.jl#L194-L209">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.CloudIceUptakeLimitation"><a class="docstring-binding" href="#AtmosphericDeposition.CloudIceUptakeLimitation"><code>AtmosphericDeposition.CloudIceUptakeLimitation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">CloudIceUptakeLimitation(; name = :CloudIceUptakeLimitation)</code></pre><p>ModelingToolkit component implementing the cloud ice uptake limitation on cold cloud wet scavenging from Luo &amp; Yu (2023), Eqs. 12–15.</p><p>In cold clouds, water-soluble aerosols are captured by ice crystals via coagulation and then removed by precipitation. The cold cloud rainout efficiency <code>F_I</code> is limited by the cloud ice uptake rate, which is approximated using the HNO₃ uptake rate from Jacob (2000).</p><p>The uptake efficiency <code>γ</code> depends on temperature following Hudson et al. (2002): γ = 0.003 at T ≥ 220 K, increasing linearly to 0.007 at T ≤ 209 K.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/de0e7268e39c3dff93d6da69a3d9d4786c8bc3df/src/luo2023.jl#L245-L259">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.WetScavengingLimitations"><a class="docstring-binding" href="#AtmosphericDeposition.WetScavengingLimitations"><code>AtmosphericDeposition.WetScavengingLimitations</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">WetScavengingLimitations(; name = :WetScavengingLimitations)</code></pre><p>ModelingToolkit component combining both the air refreshing limitation and cloud ice uptake limitation on wet scavenging from Luo &amp; Yu (2023).</p><p>This provides a complete parameterization of the two novel approaches:</p><ol><li>Air refreshing limitation (Section 2.1): Reduces wet scavenging rate when subgrid air mixing is slow relative to the removal rate.</li><li>Cloud ice uptake limitation (Section 2.2): Limits cold cloud rainout efficiency by the rate at which aerosols are captured by ice crystals.</li></ol></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/de0e7268e39c3dff93d6da69a3d9d4786c8bc3df/src/luo2023.jl#L313-L325">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="Air-Refreshing-Limitation"><a class="docs-heading-anchor" href="#Air-Refreshing-Limitation">Air Refreshing Limitation</a><a id="Air-Refreshing-Limitation-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Refreshing-Limitation" title="Permalink"></a></h3><p>The air refreshing limited removal rate <span>$R_A$</span> (Eq. 2) is:</p><p class="math-container">\[R_A = \frac{1}{\frac{1}{f R_i} + \tau_A}\]</p><p>where <span>$f$</span> is the cloud/rainfall fraction, <span>$R_i$</span> is the in-cloud/under-rain removing rate, and <span>$\tau_A$</span> is the grid refreshing time (Eq. 5):</p><p class="math-container">\[\tau_A = \frac{1 - f}{f K_i}\]</p><p>The cloudy air refreshing rate <span>$K_i$</span> (Eq. 11) depends on turbulence kinetic energy and grid spacing:</p><p class="math-container">\[K_i = \sqrt{\frac{2}{3}\text{TKE}} \left[\frac{1}{\sqrt{f}\,\Delta x} + \frac{1}{\sqrt{f}\,\Delta y} + \frac{1}{\Delta z}\right]\]</p><h3 id="Cloud-Ice-Uptake-Limitation"><a class="docs-heading-anchor" href="#Cloud-Ice-Uptake-Limitation">Cloud Ice Uptake Limitation</a><a id="Cloud-Ice-Uptake-Limitation-1"></a><a class="docs-heading-anchor-permalink" href="#Cloud-Ice-Uptake-Limitation" title="Permalink"></a></h3><p>The cold cloud rainout efficiency <span>$F_I$</span> (Eq. 12) is:</p><p class="math-container">\[F_I = 1 - e^{-R_{A,U}\,\Delta t}\]</p><p>where <span>$R_{A,U}$</span> is the air refreshing limited cloud ice uptake rate (Eq. 13):</p><p class="math-container">\[R_{A,U} = \frac{f\,R_U\,K_i}{K_i + (1-f)\,R_U}\]</p><p>The cloud ice uptake rate <span>$R_U$</span> for HNO₃ (Eq. 14, based on Jacob, 2000) is given in the original CGS form as:</p><p class="math-container">\[R_{U,\text{HNO}_3} = \frac{N_I \cdot S_I}{\frac{r}{D_g} + \frac{2.749064 \times 10^{-4}\,\sqrt{M}}{\gamma\,\sqrt{T}}}\]</p><p>where <span>$N_I$</span> is ice crystal number concentration (cm⁻³), <span>$S_I$</span> is ice crystal surface area (cm²), <span>$r$</span> is ice crystal radius (cm), <span>$D_g$</span> is gas-phase diffusion coefficient (cm² s⁻¹), <span>$M$</span> is molar mass (g mol⁻¹), <span>$T$</span> is temperature (K), and <span>$\gamma$</span> is uptake efficiency. The prefactor <span>$2.749064 \times 10^{-4}$</span> has units s cm⁻¹ and equals <span>$4\sqrt{\pi/(8R)}$</span> from kinetic gas theory, where <span>$R = 8.314 \times 10^7$</span> erg mol⁻¹ K⁻¹. The implementation uses fully SI units with <span>$R = 8.314$</span> J mol⁻¹ K⁻¹, giving a prefactor of <span>$4\sqrt{\pi/(8R)} \approx 0.8693$</span> s m⁻¹ when <span>$M$</span> is in kg mol⁻¹. <span>$M$</span> and <span>$T$</span> are non-dimensionalized by reference values of 1 kg mol⁻¹ and 1 K respectively to avoid fractional unit powers.</p><p>The uptake efficiency for HNO₃ on ice (Eq. 15, based on Hudson et al., 2002) is:</p><p class="math-container">\[\gamma = 3 \times 10^{-3} + 4 \times 10^{-3} \max\!\left(0,\, \min\!\left(1,\, \frac{220 - T}{220 - 209}\right)\right)\]</p><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, DynamicQuantities
using AtmosphericDeposition

sys = WetScavengingLimitations()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(ModelingToolkit.Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Kᵢ</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Cloudy/rainy air refreshing rate (Eq. 11)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">τ_A</td><td style = "text-align: left;">s</td><td style = "text-align: left;">Grid refreshing time (Eq. 5)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">R_A</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Air refreshing limited removal rate (Eq. 2)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">γ</td><td style = "text-align: left;"></td><td style = "text-align: left;">Uptake efficiency of HNO₃ on ice (Eq. 15) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">R_U</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Cloud ice uptake rate (Eq. 14)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">R_AU</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Air refreshing limited cloud ice uptake rate (Eq. 13)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">F_I</td><td style = "text-align: left;"></td><td style = "text-align: left;">Cold cloud rainout efficiency (Eq. 12) (dimensionless)</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">pars = parameters(sys)
DataFrame(
    :Name =&gt; [string(ModelingToolkit.Symbolics.tosymbol(p, escape = false)) for p in pars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in pars],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in pars]
)</code></pre><div><div style = "float: left;"><span>22×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T_ref</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Reference temperature for non-dimensionalization of square root</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Δx</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Grid spacing in x direction</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">M_ref</td><td style = "text-align: left;">kg mol⁻¹</td><td style = "text-align: left;">Reference molar mass for non-dimensionalization of square root</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">zero_dimless</td><td style = "text-align: left;"></td><td style = "text-align: left;">Zero (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">kinetic_prefactor_si</td><td style = "text-align: left;">m⁻¹ s</td><td style = "text-align: left;">Kinetic theory prefactor 4√(π/(8R)) for ice uptake in SI (Eq. 14), R = 8.314 J/(mol·K)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">Rᵢ</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">In-cloud or under-rain removing rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">S_I</td><td style = "text-align: left;">m²</td><td style = "text-align: left;">Ice crystal surface area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">r_ice</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Ice crystal radius</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">γ_base</td><td style = "text-align: left;"></td><td style = "text-align: left;">Base uptake efficiency (Eq. 15) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">T</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">M</td><td style = "text-align: left;">kg mol⁻¹</td><td style = "text-align: left;">Molar mass</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">N_I</td><td style = "text-align: left;">m⁻³</td><td style = "text-align: left;">Ice crystal number concentration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">T_upper_luo</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Upper temperature threshold for γ (Eq. 15)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">f</td><td style = "text-align: left;"></td><td style = "text-align: left;">Cloud or rainfall fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">TKE</td><td style = "text-align: left;">m² s⁻²</td><td style = "text-align: left;">Turbulence kinetic energy</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">Δy</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Grid spacing in y direction</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">D_g</td><td style = "text-align: left;">m² s⁻¹</td><td style = "text-align: left;">Gas-phase diffusion coefficient</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">Δt</td><td style = "text-align: left;">s</td><td style = "text-align: left;">Time step</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">Δz</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Grid spacing in z direction</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">γ_delta</td><td style = "text-align: left;"></td><td style = "text-align: left;">Temperature-dependent uptake coefficient (Eq. 15) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">one_dimless</td><td style = "text-align: left;"></td><td style = "text-align: left;">One (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">T_lower_luo</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Lower temperature threshold for γ (Eq. 15)</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{K_i}\left( t \right) &amp;= \sqrt{\frac{2}{3} \mathtt{TKE}} \left( \frac{1}{\mathtt{{\Delta}z}} + \frac{1}{\sqrt{f} \mathtt{{\Delta}x}} + \frac{1}{\sqrt{f} \mathtt{{\Delta}y}} \right) \\
\mathtt{\tau\_A}\left( t \right) &amp;= \frac{1 - f}{f \mathtt{K_i}\left( t \right)} \\
\mathtt{R\_A}\left( t \right) &amp;= \frac{1}{\mathtt{\tau\_A}\left( t \right) + \frac{1}{\mathtt{R_i} f}} \\
\gamma\left( t \right) &amp;= \mathtt{\gamma\_base} + max\left( \mathtt{zero\_dimless}, min\left( \mathtt{one\_dimless}, \frac{ - T + \mathtt{T\_upper\_luo}}{ - \mathtt{T\_lower\_luo} + \mathtt{T\_upper\_luo}} \right) \right) \mathtt{\gamma\_delta} \\
\mathtt{R\_U}\left( t \right) &amp;= \frac{\mathtt{N\_I} \mathtt{S\_I}}{\frac{\mathtt{r\_ice}}{\mathtt{D\_g}} + \frac{\mathtt{kinetic\_prefactor\_si} \sqrt{\frac{M}{\mathtt{M\_ref}}}}{\sqrt{\frac{T}{\mathtt{T\_ref}}} \gamma\left( t \right)}} \\
\mathtt{R\_AU}\left( t \right) &amp;= \frac{f \mathtt{R\_U}\left( t \right) \mathtt{K_i}\left( t \right)}{\mathtt{K_i}\left( t \right) + \left( 1 - f \right) \mathtt{R\_U}\left( t \right)} \\
\mathtt{F\_I}\left( t \right) &amp;= 1 - e^{ - \mathtt{R\_AU}\left( t \right) \mathtt{{\Delta}t}}
\end{align}
 \]</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Reported-Impacts-(Table-1,-Luo-and-Yu,-2023)"><a class="docs-heading-anchor" href="#Reported-Impacts-(Table-1,-Luo-and-Yu,-2023)">Reported Impacts (Table 1, Luo &amp; Yu, 2023)</a><a id="Reported-Impacts-(Table-1,-Luo-and-Yu,-2023)-1"></a><a class="docs-heading-anchor-permalink" href="#Reported-Impacts-(Table-1,-Luo-and-Yu,-2023)" title="Permalink"></a></h3><p>The paper reports the following relative changes (%) in concentrations of HNO₃, inorganic nitrate (InOrgNIT), NH₄, and SO₄ at different pressure levels when applying the air refreshing (AR) limitation versus the baseline (BSL), and the combined air refreshing + ice uptake (ARIU) limitation versus BSL:</p><table><tr><th style="text-align: left">Pressure</th><th style="text-align: left">HNO₃ (AR-BSL)/BSL</th><th style="text-align: left">InOrgNIT (AR-BSL)/BSL</th><th style="text-align: left">NH₄ (AR-BSL)/BSL</th><th style="text-align: left">SO₄ (AR-BSL)/BSL</th><th style="text-align: left">HNO₃ (ARIU-AR)/BSL</th><th style="text-align: left">InOrgNIT (ARIU-AR)/BSL</th><th style="text-align: left">NH₄ (ARIU-AR)/BSL</th><th style="text-align: left">SO₄ (ARIU-AR)/BSL</th></tr><tr><td style="text-align: left">&gt;800 hPa</td><td style="text-align: left">22.8</td><td style="text-align: left">22.1</td><td style="text-align: left">8.3</td><td style="text-align: left">2.0</td><td style="text-align: left">0.8</td><td style="text-align: left">0.7</td><td style="text-align: left">2.6</td><td style="text-align: left">1.7</td></tr><tr><td style="text-align: left">800–500 hPa</td><td style="text-align: left">44.2</td><td style="text-align: left">99.7</td><td style="text-align: left">43.4</td><td style="text-align: left">25.6</td><td style="text-align: left">6.2</td><td style="text-align: left">21.5</td><td style="text-align: left">19.6</td><td style="text-align: left">13.5</td></tr><tr><td style="text-align: left">&lt;500 hPa</td><td style="text-align: left">11.6</td><td style="text-align: left">283.0</td><td style="text-align: left">114.4</td><td style="text-align: left">30.3</td><td style="text-align: left">32.2</td><td style="text-align: left">843.8</td><td style="text-align: left">478.9</td><td style="text-align: left">166.8</td></tr></table><p>Key findings:</p><ul><li>Air refreshing limitation has the largest impact below 800 hPa where turbulence in the planetary boundary layer is strong</li><li>Cloud ice uptake limitation is most important above 500 hPa where cold cloud scavenging dominates</li><li>The combined effect (ARIU) shows the largest changes in the upper troposphere (&lt;500 hPa)</li></ul><p>These results were obtained using GEOS-Chem v14.1.1 and cannot be reproduced from the parameterization alone. The following analysis plots demonstrate the behavior of the individual parameterization components.</p><h3 id="Effect-of-TKE-on-Air-Refreshing-Limited-Removal-Rate"><a class="docs-heading-anchor" href="#Effect-of-TKE-on-Air-Refreshing-Limited-Removal-Rate">Effect of TKE on Air Refreshing Limited Removal Rate</a><a id="Effect-of-TKE-on-Air-Refreshing-Limited-Removal-Rate-1"></a><a class="docs-heading-anchor-permalink" href="#Effect-of-TKE-on-Air-Refreshing-Limited-Removal-Rate" title="Permalink"></a></h3><p>This figure shows how <span>$R_A / (f \cdot R_i)$</span> varies with turbulence kinetic energy (TKE) for different cloud fractions. When TKE is large (strong mixing), <span>$R_A \approx f R_i$</span> (ratio approaches 1). When TKE is small (weak mixing), the air refreshing limitation significantly reduces wet scavenging.</p><pre><code class="language-julia hljs">using AtmosphericDeposition: air_refreshing_limited_rate, grid_refreshing_time,
                             cloudy_air_refreshing_rate
using Plots

@parameters f_p Rᵢ_p [unit = u&quot;s^-1&quot;] TKE_p [unit = u&quot;m^2/s^2&quot;]
@parameters Δx_p [unit = u&quot;m&quot;] Δy_p [unit = u&quot;m&quot;] Δz_p [unit = u&quot;m&quot;]

R_A_expr = air_refreshing_limited_rate(f_p, Rᵢ_p,
    grid_refreshing_time(f_p, cloudy_air_refreshing_rate(f_p, TKE_p, Δx_p, Δy_p, Δz_p)))

# GEOS-Chem-like grid: ~200 km horizontal, ~1 km vertical
base = Dict(Rᵢ_p =&gt; 0.001, Δx_p =&gt; 200000.0, Δy_p =&gt; 200000.0, Δz_p =&gt; 1000.0)

tke_range = 10 .^ range(-2, 2, length = 100)
cloud_fracs = [0.1, 0.3, 0.5, 0.8]

p = plot(xlabel = &quot;TKE (m²/s²)&quot;, ylabel = &quot;R_A / (f·Rᵢ)&quot;,
    title = &quot;Air Refreshing Limitation vs. TKE&quot;,
    xscale = :log10, ylim = (0, 1.05), legend = :bottomright)

for f_val in cloud_fracs
    ratios = Float64[]
    for tke_val in tke_range
        vals = merge(base, Dict(f_p =&gt; f_val, TKE_p =&gt; tke_val))
        R_A_val = Float64(ModelingToolkit.Symbolics.value(substitute(R_A_expr, vals)))
        push!(ratios, R_A_val / (f_val * 0.001))
    end
    plot!(p, tke_range, ratios, label = &quot;f = $f_val&quot;)
end
p</code></pre><img src="7b50aab3.svg" alt="Example block output"/><h3 id="Effect-of-Grid-Spacing-on-Air-Refreshing-Limitation"><a class="docs-heading-anchor" href="#Effect-of-Grid-Spacing-on-Air-Refreshing-Limitation">Effect of Grid Spacing on Air Refreshing Limitation</a><a id="Effect-of-Grid-Spacing-on-Air-Refreshing-Limitation-1"></a><a class="docs-heading-anchor-permalink" href="#Effect-of-Grid-Spacing-on-Air-Refreshing-Limitation" title="Permalink"></a></h3><p>This figure shows how the air refreshing limitation depends on horizontal grid spacing (Δx = Δy) for a typical TKE value. Coarser grids experience stronger limitation because the subgrid air mixing takes longer.</p><pre><code class="language-julia hljs">R_A_expr2 = air_refreshing_limited_rate(f_p, Rᵢ_p,
    grid_refreshing_time(f_p, cloudy_air_refreshing_rate(f_p, TKE_p, Δx_p, Δy_p, Δz_p)))

base2 = Dict(f_p =&gt; 0.3, Rᵢ_p =&gt; 0.001, Δz_p =&gt; 1000.0)
dx_range = 10 .^ range(3, 6, length = 100)  # 1 km to 1000 km
tke_vals_plot = [0.1, 0.5, 1.0, 5.0]

p2 = plot(xlabel = &quot;Horizontal grid spacing (km)&quot;, ylabel = &quot;R_A / (f·Rᵢ)&quot;,
    title = &quot;Air Refreshing Limitation vs. Grid Spacing (f = 0.3)&quot;,
    xscale = :log10, ylim = (0, 1.05), legend = :topright)

for tke_val in tke_vals_plot
    ratios = Float64[]
    for dx_val in dx_range
        vals = merge(base2, Dict(TKE_p =&gt; tke_val, Δx_p =&gt; dx_val, Δy_p =&gt; dx_val))
        R_A_val = Float64(ModelingToolkit.Symbolics.value(substitute(R_A_expr2, vals)))
        push!(ratios, R_A_val / (0.3 * 0.001))
    end
    plot!(p2, dx_range ./ 1000, ratios, label = &quot;TKE = $tke_val m²/s²&quot;)
end
p2</code></pre><img src="7bfd5241.svg" alt="Example block output"/><h3 id="HNO-Uptake-Efficiency-on-Ice-(Eq.-15)"><a class="docs-heading-anchor" href="#HNO-Uptake-Efficiency-on-Ice-(Eq.-15)">HNO₃ Uptake Efficiency on Ice (Eq. 15)</a><a id="HNO-Uptake-Efficiency-on-Ice-(Eq.-15)-1"></a><a class="docs-heading-anchor-permalink" href="#HNO-Uptake-Efficiency-on-Ice-(Eq.-15)" title="Permalink"></a></h3><p>The uptake efficiency <span>$\gamma$</span> of nitric acid on ice crystals as a function of temperature, based on Hudson et al. (2002). The efficiency transitions from 0.003 at <span>$T \geq 220$</span> K to 0.007 at <span>$T \leq 209$</span> K.</p><pre><code class="language-julia hljs">using AtmosphericDeposition: hno3_uptake_efficiency, T_upper_luo, T_lower_luo,
                             γ_base, γ_delta, zero_dimless, one_dimless

@parameters T_plot [unit = u&quot;K&quot;]
γ_expr = hno3_uptake_efficiency(T_plot)

const_defaults = Dict(
    T_upper_luo =&gt; 220.0, T_lower_luo =&gt; 209.0,
    γ_base =&gt; 3e-3, γ_delta =&gt; 4e-3,
    zero_dimless =&gt; 0.0, one_dimless =&gt; 1.0
)

T_range = 190.0:0.5:240.0
γ_vals = [Float64(ModelingToolkit.Symbolics.value(
              substitute(γ_expr, merge(const_defaults, Dict(T_plot =&gt; T_val)))))
          for T_val in T_range]

p3 = plot(T_range, γ_vals .* 1000,
    xlabel = &quot;Temperature (K)&quot;, ylabel = &quot;γ (×10⁻³)&quot;,
    title = &quot;HNO₃ Uptake Efficiency on Ice (Eq. 15, Hudson et al., 2002)&quot;,
    legend = false, linewidth = 2)
vline!([209.0, 220.0], linestyle = :dash, color = :gray, label = &quot;&quot;)
p3</code></pre><img src="10b47e7a.svg" alt="Example block output"/><h3 id="Cold-Cloud-Rainout-Efficiency"><a class="docs-heading-anchor" href="#Cold-Cloud-Rainout-Efficiency">Cold Cloud Rainout Efficiency</a><a id="Cold-Cloud-Rainout-Efficiency-1"></a><a class="docs-heading-anchor-permalink" href="#Cold-Cloud-Rainout-Efficiency" title="Permalink"></a></h3><p>The cold cloud rainout efficiency <span>$F_I$</span> as a function of the air refreshing limited cloud ice uptake rate <span>$R_{A,U}$</span> for different time steps. Longer time steps and higher uptake rates lead to more complete scavenging.</p><pre><code class="language-julia hljs">using AtmosphericDeposition: cold_cloud_rainout_efficiency

@parameters R_AU_plot [unit = u&quot;s^-1&quot;]
@parameters Δt_plot [unit = u&quot;s&quot;]
F_I_expr = cold_cloud_rainout_efficiency(R_AU_plot, Δt_plot)

R_AU_range = 10 .^ range(-5, -1, length = 100)
dt_vals = [60.0, 300.0, 600.0, 1800.0, 3600.0]

p4 = plot(xlabel = &quot;R_A,U (s⁻¹)&quot;, ylabel = &quot;F_I&quot;,
    title = &quot;Cold Cloud Rainout Efficiency (Eq. 12)&quot;,
    xscale = :log10, ylim = (0, 1.05), legend = :topleft)

for dt_val in dt_vals
    F_I_vals = [Float64(ModelingToolkit.Symbolics.value(
                    substitute(F_I_expr, Dict(R_AU_plot =&gt; rau, Δt_plot =&gt; dt_val))))
                for rau in R_AU_range]
    label_str = dt_val &lt; 3600 ? &quot;Δt = $(Int(dt_val)) s&quot; : &quot;Δt = $(Int(dt_val/3600)) h&quot;
    plot!(p4, R_AU_range, F_I_vals, label = label_str)
end
p4</code></pre><img src="ae1d638e.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../seinfeld_pandis_2006_ch20/">« Seinfeld &amp; Pandis (2006) Ch. 20</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Thursday 12 February 2026 18:48">Thursday 12 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
