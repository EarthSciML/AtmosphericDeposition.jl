var documenterSearchIndex = {"docs":
[{"location":"api/#Index","page":"API","title":"Index","text":"","category":"section"},{"location":"api/#API-Documentation","page":"API","title":"API Documentation","text":"","category":"section"},{"location":"api/#AtmosphericDeposition.z₀_table","page":"API","title":"AtmosphericDeposition.z₀_table","text":"Values for the characteristic radii of collectors [m] where the columns are land use categories and the rows are seasonal categories. Given in Seinfeld and Pandis Table 19.2\n\nLand use options are given in SeinfeldLandUse and season options are given in SeinfeldSeason.\n\n\n\n\n\n","category":"constant"},{"location":"api/#AtmosphericDeposition.BelowCloudGasScavenging-Tuple{}","page":"API","title":"AtmosphericDeposition.BelowCloudGasScavenging","text":"BelowCloudGasScavenging(; name = :BelowCloudGasScavenging)\n\nModelingToolkit component for irreversible below-cloud gas scavenging. Computes the scavenging coefficient (Eq. 20.25), the below-cloud flux (Eq. 20.22), and the exponential gas concentration decay (Eq. 20.24).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.DryDepGas-Tuple{Any, Any, Any, Any, Any, Any, AtmosphericDeposition.GasData, Any, Any, Any, Any, Any, Vararg{Bool, 4}}","page":"API","title":"AtmosphericDeposition.DryDepGas","text":"Function DryDepGas calculates dry deposition velocity [m/s] for a gas species, where z is the height of the surface layer [m], zo is roughness length [m], u_star is friction velocity [m/s], L is Monin-Obukhov length [m], T is surface air temperature [K], ρA is air density [kg/m3] gasData is data about the gas species for surface resistance calculations, G is solar irradiation [W m-2], Θ is the slope of the local terrain [radians], iSeason and iLandUse are indexes for the season and land use, dew and rain indicate whether there is dew or rain on the ground, and isSO2 and isO3 indicate whether the gas species of interest is either SO2 or O3, respectively. Based on Seinfeld and Pandis (2006) equation 19.2.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.DryDepParticle-NTuple{14, Any}","page":"API","title":"AtmosphericDeposition.DryDepParticle","text":"Function DryDepParticle calculates particle dry deposition velocity [m/s] where z is the height of the surface layer [m], zo is roughness length [m], u_star is friction velocity [m/s], L is Monin-Obukhov length [m], Dp is particle diameter [m], Ts is surface air temperature [K], P is pressure [Pa], ρParticle is particle density [kg/m3], ρAir is air density [kg/m3], and iSeason and iLandUse are indexes for the season and land use. Based on Seinfeld and Pandis (2006) equation 19.7.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.DryDepositionAerosol-Tuple{}","page":"API","title":"AtmosphericDeposition.DryDepositionAerosol","text":"Aerosol dry deposition based on Seinfeld and Pandis (2006) equation 19.7.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.DryDepositionGas-Tuple{}","page":"API","title":"AtmosphericDeposition.DryDepositionGas","text":"DescriptionGas: This is a box model used to calculate the gas species concentration rate changed by dry deposition. Build Dry deposition model (gas)\n\nExample\n\n@parameters t\nd = DrydepositionGas(t)\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.GasScavengingCoeff-Tuple{}","page":"API","title":"AtmosphericDeposition.GasScavengingCoeff","text":"GasScavengingCoeff(; name = :GasScavengingCoeff)\n\nModelingToolkit component for the irreversible gas scavenging coefficient (Eq. 20.25, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.MassTransferCoeff-Tuple{}","page":"API","title":"AtmosphericDeposition.MassTransferCoeff","text":"MassTransferCoeff(; name = :MassTransferCoeff)\n\nModelingToolkit component for the gas-phase mass transfer coefficient to a raindrop (Eq. 20.12, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.ParticleCollectionEfficiency-Tuple{}","page":"API","title":"AtmosphericDeposition.ParticleCollectionEfficiency","text":"ParticleCollectionEfficiency(; name = :ParticleCollectionEfficiency)\n\nModelingToolkit component for the Slinn (1983) semi-empirical particle-drop collision (collection) efficiency (Eq. 20.53–20.54, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.ParticleScavengingCoeff-Tuple{}","page":"API","title":"AtmosphericDeposition.ParticleScavengingCoeff","text":"ParticleScavengingCoeff(; name = :ParticleScavengingCoeff)\n\nModelingToolkit component for the particle scavenging coefficient with monodisperse raindrops (Eq. 20.57, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.RbGas-Tuple{Any, Any}","page":"API","title":"AtmosphericDeposition.RbGas","text":"Function RbGas calculates the quasi-laminar sublayer resistance to dry deposition for a gas species [s/m], where Sc is the dimensionless Schmidt number and u_star is the friction velocity [m/s]. From Seinfeld and Pandis (2006) equation 19.17.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.RbParticle-NTuple{6, Any}","page":"API","title":"AtmosphericDeposition.RbParticle","text":"Function RbParticle calculates the quasi-laminar sublayer resistance to dry deposition for a particles [s/m], where Sc is the dimensionless Schmidt number, u_star is the friction velocity [m/s], St is the dimensionless Stokes number, Dp is particle diameter [m], and iSeason and iLandUse are season and land use indexes, respectively. From Seinfeld and Pandis (2006) equation 19.27.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.ReversibleGasScavenging-Tuple{}","page":"API","title":"AtmosphericDeposition.ReversibleGasScavenging","text":"ReversibleGasScavenging(; name = :ReversibleGasScavenging)\n\nModelingToolkit component for reversible below-cloud gas scavenging (Eqs. 20.28, 20.33, 20.35, Seinfeld & Pandis, 2006).\n\nThe parameter HRT is the dimensionless product H* × R × T × 1000 (effective Henry's law coefficient × gas constant × temperature × unit conversion). For HNO₃ at 298 K: HRT = 2.1e5 × 8.206e-5 × 298 × 1000 ≈ 5.14e6.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.WetDeposition-Tuple{}","page":"API","title":"AtmosphericDeposition.WetDeposition","text":"Description: This is a box model used to calculate wet deposition based on formulas at EMEP model. Build WetDeposition model\n\nExample\n\n@parameters t\nwd = WetDeposition(t)\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.WetDepositionFlux-Tuple{}","page":"API","title":"AtmosphericDeposition.WetDepositionFlux","text":"WetDepositionFlux(; name = :WetDepositionFlux)\n\nModelingToolkit component for the net wet deposition flux and velocity (Eqs. 20.7–20.9, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition._WetDeposition-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition._WetDeposition","text":"Calculate wet deposition based on formulas at https://www.emep.int/publ/reports/2003/emepreport1part12003.pdf. Inputs are fraction of grid cell covered by clouds (cloudFrac), rain mixing ratio (qrain), air density (ρ_air [kg/m3]), and fall distance (Δz [m]). Outputs are wet deposition rates for PM2.5, SO2, and other gases (wdParticle, wdSO2, and wdOtherGas [1/s]).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.cc-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.cc","text":"Function cc calculates the Cunnningham slip correction factor where Dp is particle diameter [m], T is temperature [K], and P is pressure [Pa]. From Seinfeld and Pandis (2006) equation 9.34.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.dH2O-Tuple{Any}","page":"API","title":"AtmosphericDeposition.dH2O","text":"Function dH2O calculates molecular diffusivity of water vapor in air [m2/s] where T is temperature [K] using a regression fit to data in Bolz and Tuve (1976) found here: http://www.cambridge.org/us/engineering/author/nellisandklein/downloads/examples/EXAMPLE_9.2-1.pdf\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.dParticle-NTuple{5, Any}","page":"API","title":"AtmosphericDeposition.dParticle","text":"Function dParticle calculates the brownian diffusivity of a particle [m2/s] using the Stokes-Einstein-Sutherland relation (Seinfeld and Pandis eq. 9.73) where T is air temperature [K], P is pressure [Pa], Dp is particle diameter [m], and μ is air dynamic viscosity [kg/(s m)]\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.gas_scavenging_coeff-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.gas_scavenging_coeff","text":"gas_scavenging_coeff(K_c, U_t, D_p, p₀_SI)\n\nCompute the below-cloud gas scavenging coefficient for irreversible uptake by monodisperse raindrops (Eq. 20.25 in Seinfeld & Pandis, 2006).\n\nAll arguments in SI units. p₀_SI is precipitation rate in m/s.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.mass_transfer_coeff-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.mass_transfer_coeff","text":"mass_transfer_coeff(D_g, D_p, U_t)\n\nCompute the gas-phase mass transfer coefficient to a spherical drop using the Sherwood number correlation (Eq. 20.12 in Seinfeld & Pandis, 2006).\n\nArguments\n\nD_g: gas-phase diffusivity [m²/s]\nD_p: raindrop diameter [m]\nU_t: terminal velocity of the raindrop [m/s]\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.mfp-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.mfp","text":"Function mfp calculates the mean free path of air [m] where T is temperature [K] P is pressure [Pa], and Mu is dynamic viscosity [kg/(m s)]. From Seinfeld and Pandis (2006) equation 9.6\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.mu-Tuple{Any}","page":"API","title":"AtmosphericDeposition.mu","text":"Function mu calculates the dynamic viscosity of air [kg m-1 s-1] where T is temperature [K].\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.particle_diffusivity-Tuple{Any, Any}","page":"API","title":"AtmosphericDeposition.particle_diffusivity","text":"particle_diffusivity(d_p, T)\n\nCompute Brownian diffusivity of an aerosol particle via Stokes-Einstein: Ddiff = kB * T / (3π * μair * dp).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.particle_relaxation_time-Tuple{Any, Any}","page":"API","title":"AtmosphericDeposition.particle_relaxation_time","text":"particle_relaxation_time(d_p, ρ_p)\n\nCompute the particle relaxation time τ = ρp * dp² / (18 * μ_air) for Stokes drag regime.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.particle_scavenging_coeff-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.particle_scavenging_coeff","text":"particle_scavenging_coeff(E, p₀_SI, D_p)\n\nCompute the particle scavenging coefficient for monodisperse raindrops (Eq. 20.57, Seinfeld & Pandis, 2006).\n\nArguments\n\nE: collection efficiency (dimensionless)\np₀_SI: precipitation rate [m/s]\nD_p: raindrop diameter [m]\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.particle_terminal_velocity-Tuple{Any, Any}","page":"API","title":"AtmosphericDeposition.particle_terminal_velocity","text":"particle_terminal_velocity(d_p, ρ_p)\n\nCompute the Stokes settling velocity u_t = τ * g for small particles.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.ra-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.ra","text":"Function Ra calculates aerodynamic resistance to dry deposition where z is the top of the surface layer [m], z₀ is the roughness length [m], u_star is friction velocity [m/s], and L is Monin-Obukhov length [m] Based on Seinfeld and Pandis (2006) [Seinfeld, J.H. and Pandis, S.N. (2006) Atmospheric Chemistry and Physics: From Air Pollution to Climate Change. 2nd Edition, John Wiley & Sons, New York.] equation 19.13 & 19.14.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.reversible_drop_conc-NTuple{7, Any}","page":"API","title":"AtmosphericDeposition.reversible_drop_conc","text":"reversible_drop_conc(C_g, HRT, K_c, D_p, U_t, z, C_aq0)\n\nCompute the aqueous-phase concentration in a falling raindrop at fall distance z from cloud base for a reversibly-absorbed gas species (Eq. 20.28, Seinfeld & Pandis, 2006).\n\nHRT = H* × R × T × 1000 (dimensionless), representing the ratio Caqeq / C_g when both are in mol/m³.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.reversible_scavenging_flux-NTuple{8, Any}","page":"API","title":"AtmosphericDeposition.reversible_scavenging_flux","text":"reversible_scavenging_flux(C_g, HRT, K_c, D_p, U_t, h, C_aq0, p₀_SI)\n\nCompute the total below-cloud scavenging rate for a reversibly-absorbed gas (Eq. 20.35, Seinfeld & Pandis, 2006). All SI units.\n\nHRT = H* × R × T × 1000 (dimensionless). p₀_SI = precipitation rate [m/s].\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.sc-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.sc","text":"Function sc computes the dimensionless Schmidt number, where μ is dynamic viscosity of air [kg/(s m)], ρ is air density [kg/m3], and D is the molecular diffusivity of the gas speciesof interest [m2/s]\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.slinn_collection_efficiency-NTuple{5, Any}","page":"API","title":"AtmosphericDeposition.slinn_collection_efficiency","text":"slinn_collection_efficiency(D_p, U_t, d_p, ρ_p, T)\n\nCompute the semi-empirical collision (collection) efficiency E between a raindrop of diameter D_p and an aerosol particle of diameter d_p (Eq. 20.53–20.54, Seinfeld & Pandis, 2006).\n\nThe three terms represent:\n\nBrownian diffusion\nInterception\nInertial impaction (Stokes number term)\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.stSmooth-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.stSmooth","text":"Function stSmooth computes the dimensionless Stokes number for dry deposition of particles on smooth surfaces or surfaces with bluff roughness elements, where vs is settling velocity [m/s], u_star is friction velocity [m/s], μ is dynamic viscosity of air [kg/(s m)], and ρ is air density [kg/m3], based on Seinfeld and Pandis (2006) equation 19.23.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.stVeg-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.stVeg","text":"Function stVeg computes the dimensionless Stokes number for dry deposition of particles on vegetated surfaces, where vs is settling velocity [m/s], u_star is friction velocity [m/s], and A is the characteristic collector radius [m], based on Seinfeld and Pandis (2006) equation 19.24.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.vs-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.vs","text":"Function vs calculates the terminal setting velocity of a particle where Dp is particle diameter [m], ρₚ is particle density [kg/m3], Cc is the Cunningham slip correction factor, and μ is air dynamic viscosity [kg/(s m)]. From equation 9.42 in Seinfeld and Pandis (2006).\n\n\n\n\n\n","category":"method"},{"location":"seinfeld_pandis_ch19/#DryDeposition.jl","page":"Seinfeld & Pandis Ch. 19","title":"DryDeposition.jl","text":"","category":"section"},{"location":"seinfeld_pandis_ch19/#Overview","page":"Seinfeld & Pandis Ch. 19","title":"Overview","text":"DryDeposition.jl is a ModelingToolkit.jl implementation of the dry deposition equations from Chapter 19 of Seinfeld and Pandis (2006). Dry deposition is the transport of gaseous and particulate species from the atmosphere onto surfaces in the absence of precipitation.\n\nThe package implements the resistance model for dry deposition, which represents the deposition process using an electrical resistance analogy. The transport of material to the surface is governed by three resistances in series:\n\nAerodynamic resistance (r_a): Turbulent transport through the atmospheric surface layer\nQuasi-laminar resistance (r_b): Molecular/Brownian diffusion across the thin stagnant layer adjacent to the surface\nSurface resistance (r_c): Uptake at the surface (for gases only; particles are assumed to stick on contact)","category":"section"},{"location":"seinfeld_pandis_ch19/#Gas-Deposition","page":"Seinfeld & Pandis Ch. 19","title":"Gas Deposition","text":"For gases, the deposition velocity is given by:\n\nv_d = frac1r_a + r_b + r_c","category":"section"},{"location":"seinfeld_pandis_ch19/#Particle-Deposition","page":"Seinfeld & Pandis Ch. 19","title":"Particle Deposition","text":"For particles, gravitational settling operates in parallel with the resistance pathway:\n\nv_d = frac1r_a + r_b + r_a r_b v_s + v_s\n\nwhere v_s is the particle settling velocity.","category":"section"},{"location":"seinfeld_pandis_ch19/#Reference","page":"Seinfeld & Pandis Ch. 19","title":"Reference","text":"Seinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd Edition, Chapter 19: Dry Deposition. John Wiley & Sons, Inc.","category":"section"},{"location":"seinfeld_pandis_ch19/#Package-Contents","page":"Seinfeld & Pandis Ch. 19","title":"Package Contents","text":"This package provides the following equation system implementations:\n\nComponent Equations Description\nDryDeposition.AerodynamicResistance Eq. 19.14 Aerodynamic resistance for neutral stability\nDryDeposition.QuasiLaminarResistanceGas Eq. 19.17 Quasi-laminar resistance for gaseous species\nDryDeposition.ParticleSettling Eq. 19.18, 19.20 Particle settling velocity and Brownian diffusivity\nDryDeposition.QuasiLaminarResistanceParticle Eq. 19.27 Quasi-laminar resistance for particles (Zhang et al. 2001)\nDryDeposition.SurfaceResistance Eq. 19.50-19.52 Surface resistance using Wesely (1989) model\nDryDeposition.DryDepositionGas Eq. 19.2 Complete gas deposition velocity\nDryDeposition.DryDepositionParticle Eq. 19.7 Complete particle deposition velocity","category":"section"},{"location":"seinfeld_pandis_ch19/#Quick-Start","page":"Seinfeld & Pandis Ch. 19","title":"Quick Start","text":"using ModelingToolkit\nusing ModelingToolkit: t\n\n# Include the module\ninclude(\"src/DryDeposition.jl\")\nusing .DryDeposition\n\n# Create a particle deposition system\n@named part_dep = DryDepositionParticle()\n\n# View system structure\nunknowns(part_dep)\nparameters(part_dep)\nequations(part_dep)","category":"section"},{"location":"seinfeld_pandis_ch19/#Physical-Constants","page":"Seinfeld & Pandis Ch. 19","title":"Physical Constants","text":"The module uses the following physical constants:\n\nConstant Value Description\nkappa 0.4 von Karman constant\ng 9.81 m/s^2 Gravitational acceleration\nk_B 1.38e-23 J/K Boltzmann constant\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Equation-Systems","page":"Seinfeld & Pandis Ch. 19","title":"Equation Systems","text":"This section provides detailed documentation of each equation system implemented in DryDeposition.jl, including state variables, parameters, and the governing equations.","category":"section"},{"location":"seinfeld_pandis_ch19/#Aerodynamic-Resistance-(Eq.-19.14)","page":"Seinfeld & Pandis Ch. 19","title":"Aerodynamic Resistance (Eq. 19.14)","text":"The aerodynamic resistance represents the turbulent transport of material from the bulk atmosphere down to the quasi-laminar sublayer. Under neutral stability conditions:\n\nr_a = frac1kappa u_* lnleft(fraczz_0right)\n\nwhere:\n\nkappa = 04 is the von Karman constant\nu_* is the friction velocity (m/s)\nz is the reference height (m)\nz_0 is the surface roughness length (m)","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = AerodynamicResistance()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Parameters","page":"Seinfeld & Pandis Ch. 19","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Quasi-Laminar-Resistance-for-Gases-(Eq.-19.17)","page":"Seinfeld & Pandis Ch. 19","title":"Quasi-Laminar Resistance for Gases (Eq. 19.17)","text":"The quasi-laminar resistance for gases depends on the molecular diffusivity of the gas through the Schmidt number:\n\nr_b = frac5  textSc^23u_*\n\nwhere the Schmidt number is textSc = nu  D_g, with nu being the kinematic viscosity of air and D_g the molecular diffusivity of the gas.","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables-2","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = QuasiLaminarResistanceGas()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Parameters-2","page":"Seinfeld & Pandis Ch. 19","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations-2","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Particle-Settling-(Eq.-19.18,-19.20)","page":"Seinfeld & Pandis Ch. 19","title":"Particle Settling (Eq. 19.18, 19.20)","text":"Particle settling velocity follows Stokes' law with slip correction:\n\nv_s = fracrho_p D_p^2 g C_c18 mu\n\nThe Brownian diffusivity of particles is given by:\n\nD = frack_B T C_c3 pi mu D_p\n\nwhere:\n\nrho_p is the particle density (kg/m^3)\nD_p is the particle diameter (m)\ng is gravitational acceleration (m/s^2)\nC_c is the Cunningham slip correction factor (dimensionless)\nmu is the dynamic viscosity of air (Pa s)\nk_B is the Boltzmann constant (J/K)\nT is temperature (K)","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables-3","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = ParticleSettling()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Parameters-3","page":"Seinfeld & Pandis Ch. 19","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations-3","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Quasi-Laminar-Resistance-for-Particles-(Eq.-19.27)","page":"Seinfeld & Pandis Ch. 19","title":"Quasi-Laminar Resistance for Particles (Eq. 19.27)","text":"The Zhang et al. (2001) model calculates particle quasi-laminar resistance based on three collection mechanisms:\n\nr_b = frac13 u_* (E_B + E_IM + E_IN) R_1\n\nwhere:\n\nBrownian diffusion efficiency (Eq. 19.21):\n\nE_B = textSc^-gamma\n\nImpaction efficiency (Eq. 19.22):\n\nE_IM = left(fractextStalpha + textStright)^2\n\nInterception efficiency (Eq. 19.25):\n\nE_IN = frac12left(fracD_pAright)^2\n\nSticking fraction (Eq. 19.26):\n\nR_1 = exp(-sqrttextSt)\n\nStokes number for vegetated surfaces (Eq. 19.24):\n\ntextSt = fracv_s u_*g A\n\nThe parameters alpha, gamma, and A depend on land-use category (Table 19.2).","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables-4","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = QuasiLaminarResistanceParticle()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Parameters-4","page":"Seinfeld & Pandis Ch. 19","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations-4","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)","category":"section"},{"location":"seinfeld_pandis_ch19/#Land-Use-Parameters-(Table-19.2)","page":"Seinfeld & Pandis Ch. 19","title":"Land-Use Parameters (Table 19.2)","text":"Land Use Category A (mm) alpha gamma\nGrass 2.0 1.2 0.54\nDeciduous Forest 5.0 0.8 0.56\nDesert 10.0 50.0 0.54\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Surface-Resistance-(Eq.-19.50-19.52)","page":"Seinfeld & Pandis Ch. 19","title":"Surface Resistance (Eq. 19.50-19.52)","text":"The Wesely (1989) model calculates surface resistance for gases using multiple parallel pathways:\n\nr_c = left(frac1r_st + r_m + frac1r_lu + frac1r_dc + r_cl + frac1r_ac + r_gsright)^-1\n\nStomatal resistance (Eq. 19.51):\n\nr_st = r_i left1 + left(frac200G + 01right)^2right leftfrac400T_s(40 - T_s)right\n\nMesophyll resistance (Eq. 19.52):\n\nr_m = frac133 times 10^-4 H^* + 100 f_0\n\nwhere:\n\nr_i is the minimum stomatal resistance\nG is solar irradiance (W/m^2)\nT_s is surface temperature (Celsius, valid range 0-40)\nH^* is the effective Henry's law constant\nf_0 is the reactivity factor (0-1)","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables-5","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = SurfaceResistance()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Parameters-5","page":"Seinfeld & Pandis Ch. 19","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [string(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations-5","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)","category":"section"},{"location":"seinfeld_pandis_ch19/#Gas-Properties-(Table-19.4)","page":"Seinfeld & Pandis Ch. 19","title":"Gas Properties (Table 19.4)","text":"Species D_H_2OD_gas H^* (M/atm) f_0\nSO2 1.9 10^5 0\nO3 1.6 0.01 1\nNO2 1.6 0.01 0.1\nHNO3 1.9 10^14 0\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Complete-Gas-Deposition-System-(Eq.-19.2)","page":"Seinfeld & Pandis Ch. 19","title":"Complete Gas Deposition System (Eq. 19.2)","text":"The DryDepositionGas component composes the aerodynamic, quasi-laminar, and surface resistance systems to calculate the complete gas deposition velocity:\n\nv_d = frac1r_a + r_b + r_c\n\nand the deposition flux (Eq. 19.1):\n\nF = -v_d C","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables-6","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = DryDepositionGas()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations-6","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Complete-Particle-Deposition-System-(Eq.-19.7)","page":"Seinfeld & Pandis Ch. 19","title":"Complete Particle Deposition System (Eq. 19.7)","text":"The DryDepositionParticle component composes the aerodynamic, settling, and quasi-laminar resistance systems to calculate the complete particle deposition velocity:\n\nv_d = frac1r_a + r_b + r_a r_b v_s + v_s\n\nThis accounts for gravitational settling operating in parallel with the turbulent/diffusive transport pathway.","category":"section"},{"location":"seinfeld_pandis_ch19/#State-Variables-7","page":"Seinfeld & Pandis Ch. 19","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing AtmosphericDeposition.DryDeposition\n\n@named sys = DryDepositionParticle()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [string(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_ch19/#Equations-7","page":"Seinfeld & Pandis Ch. 19","title":"Equations","text":"equations(sys)\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Analysis","page":"Seinfeld & Pandis Ch. 19","title":"Analysis","text":"This section reproduces key figures from Seinfeld and Pandis (2006) Chapter 19 to validate the implementation and demonstrate the physical behavior of the dry deposition model.","category":"section"},{"location":"seinfeld_pandis_ch19/#Figure-19.2:-Particle-Deposition-Velocity-vs.-Diameter","page":"Seinfeld & Pandis Ch. 19","title":"Figure 19.2: Particle Deposition Velocity vs. Diameter","text":"Figure 19.2 (page 905) shows the characteristic V-shaped curve of particle deposition velocity as a function of particle diameter. The minimum in deposition velocity occurs in the 0.1-1.0 micrometer range, often called the \"accumulation mode.\"","category":"section"},{"location":"seinfeld_pandis_ch19/#Physical-Explanation","page":"Seinfeld & Pandis Ch. 19","title":"Physical Explanation","text":"Small particles (< 0.1 micrometer): Efficiently transported by Brownian diffusion across the quasi-laminar sublayer\nIntermediate particles (0.1-1.0 micrometer): Neither Brownian diffusion nor impaction/settling is effective - the \"accumulation mode\"\nLarge particles (> 1 micrometer): Efficiently deposited by impaction, interception, and gravitational settling\n\nusing Plots\n\n# Physical constants\nconst k_B = 1.38e-23  # Boltzmann constant (J/K)\nconst g = 9.81        # Gravitational acceleration (m/s^2)\n\n# Air properties at 298 K\nconst T = 298.0       # Temperature (K)\nconst mu = 1.85e-5    # Dynamic viscosity (Pa*s)\nconst nu = 1.55e-5    # Kinematic viscosity (m^2/s)\nconst rho_p = 1000.0  # Particle density (kg/m^3) - unit density\n\n# Land-use parameters for grass (Table 19.2)\nconst A = 2.0e-3      # Characteristic collector radius (m)\nconst alpha = 1.2     # Impaction parameter\nconst gamma_param = 0.54  # Brownian diffusion parameter\n\n# Aerodynamic parameters\nconst z = 10.0        # Reference height (m)\nconst z_0 = 0.1       # Roughness length for grass (m)\nconst kappa = 0.4     # von Karman constant\n\n\"\"\"\nCalculate Cunningham slip correction factor.\nApproximation valid for particles in air at STP.\n\"\"\"\nfunction cunningham_correction(D_p)\n    # Mean free path of air at 298 K (m)\n    lambda = 6.8e-8\n    Kn = 2 * lambda / D_p  # Knudsen number\n    return 1 + Kn * (1.257 + 0.4 * exp(-1.1 / Kn))\nend\n\n\"\"\"\nCalculate particle settling velocity (Eq. 19.18).\n\"\"\"\nfunction settling_velocity(D_p, C_c)\n    return rho_p * D_p^2 * g * C_c / (18 * mu)\nend\n\n\"\"\"\nCalculate Brownian diffusivity (Eq. 19.20).\n\"\"\"\nfunction brownian_diffusivity(D_p, C_c)\n    return k_B * T * C_c / (3 * pi * mu * D_p)\nend\n\n\"\"\"\nCalculate particle deposition velocity using Zhang et al. (2001) model.\n\"\"\"\nfunction particle_deposition_velocity(D_p, u_star)\n    # Cunningham correction\n    C_c = cunningham_correction(D_p)\n\n    # Settling velocity (Eq. 19.18)\n    v_s = settling_velocity(D_p, C_c)\n\n    # Brownian diffusivity (Eq. 19.20)\n    D_diff = brownian_diffusivity(D_p, C_c)\n\n    # Schmidt number\n    Sc = nu / D_diff\n\n    # Stokes number for vegetated surfaces (Eq. 19.24)\n    St = v_s * u_star / (g * A)\n\n    # Collection efficiencies\n    E_B = Sc^(-gamma_param)                # Brownian diffusion (Eq. 19.21)\n    E_IM = (St / (alpha + St))^2          # Impaction (Eq. 19.22)\n    E_IN = 0.5 * (D_p / A)^2              # Interception (Eq. 19.25)\n\n    # Sticking fraction (Eq. 19.26)\n    R_1 = exp(-sqrt(St))\n\n    # Quasi-laminar resistance (Eq. 19.27)\n    r_b = 1 / (3 * u_star * (E_B + E_IM + E_IN) * R_1)\n\n    # Aerodynamic resistance (Eq. 19.14)\n    r_a = (1 / (kappa * u_star)) * log(z / z_0)\n\n    # Particle deposition velocity (Eq. 19.7)\n    v_d = 1 / (r_a + r_b + r_a * r_b * v_s) + v_s\n\n    return v_d, v_s, E_B, E_IM, E_IN\nend\n\n# Generate data for different friction velocities (matching Figure 19.2 conditions)\nD_p_range = 10 .^ range(-2, 2, length = 100) .* 1e-6  # 0.01 to 100 um\n\n# Multiple friction velocities to show dependence\nu_star_values = [0.11, 0.44, 1.17]  # m/s (from Figure 19.2 legend)\nu_star_labels = [\"u* = 0.11 m/s (z0 = 0.002 cm)\",\n    \"u* = 0.44 m/s (z0 = 0.02 cm)\",\n    \"u* = 1.17 m/s (z0 = 0.1 cm)\"]\n\n# Create the plot\np = plot(\n    xlabel = \"Particle Diameter (micrometer)\",\n    ylabel = \"Deposition Velocity (cm/s)\",\n    title = \"Figure 19.2: Particle Dry Deposition Velocity\",\n    xscale = :log10,\n    yscale = :log10,\n    xlims = (0.01, 100),\n    ylims = (0.01, 100),\n    legend = :bottomright,\n    size = (700, 500),\n    grid = true,\n    minorgrid = true\n)\n\ncolors = [:blue, :red, :green]\nfor (i, u_star) in enumerate(u_star_values)\n    v_d_values = Float64[]\n    v_s_values = Float64[]\n\n    for D_p in D_p_range\n        v_d, v_s, _, _, _ = particle_deposition_velocity(D_p, u_star)\n        push!(v_d_values, v_d * 100)  # Convert to cm/s\n        push!(v_s_values, v_s * 100)  # Convert to cm/s\n    end\n\n    plot!(p, D_p_range .* 1e6, v_d_values,\n        label = u_star_labels[i],\n        linewidth = 2,\n        color = colors[i])\nend\n\n# Add settling velocity line\nv_s_line = [settling_velocity(D_p, cunningham_correction(D_p)) * 100 for D_p in D_p_range]\nplot!(p, D_p_range .* 1e6, v_s_line,\n    label = \"Settling velocity (v_s)\",\n    linewidth = 2,\n    linestyle = :dash,\n    color = :black)\n\n# Add annotation for minimum region\nannotate!(p, 0.3, 0.03, text(\"Accumulation\\nMode\", 8, :center))\n\nsavefig(p, \"figure19_2.png\")\np","category":"section"},{"location":"seinfeld_pandis_ch19/#Interpretation","page":"Seinfeld & Pandis Ch. 19","title":"Interpretation","text":"The figure demonstrates several key features of particle dry deposition:\n\nMinimum at 0.1-1 micrometer: The deposition velocity reaches a minimum in the accumulation mode where neither Brownian diffusion nor impaction/settling is effective.\nDependence on friction velocity: Higher u_* leads to higher deposition velocities due to increased turbulent transport and impaction efficiency.\nAsymptotic behavior:\nFor very small particles, v_d propto D_p^-23 due to Brownian diffusion\nFor very large particles, v_d approx v_s propto D_p^2 due to gravitational settling\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Collection-Efficiency-Components","page":"Seinfeld & Pandis Ch. 19","title":"Collection Efficiency Components","text":"This figure shows the individual collection efficiency terms (Brownian diffusion, impaction, and interception) as a function of particle diameter.\n\nusing Plots\n\nconst k_B = 1.38e-23\nconst g = 9.81\nconst T = 298.0\nconst mu = 1.85e-5\nconst nu = 1.55e-5\nconst rho_p = 1000.0\n\nconst A = 2.0e-3\nconst alpha = 1.2\nconst gamma_param = 0.54\nconst u_star = 0.4\n\nfunction cunningham_correction(D_p)\n    lambda = 6.8e-8\n    Kn = 2 * lambda / D_p\n    return 1 + Kn * (1.257 + 0.4 * exp(-1.1 / Kn))\nend\n\nfunction collection_efficiencies(D_p)\n    C_c = cunningham_correction(D_p)\n\n    # Settling velocity\n    v_s = rho_p * D_p^2 * g * C_c / (18 * mu)\n\n    # Brownian diffusivity\n    D_diff = k_B * T * C_c / (3 * pi * mu * D_p)\n\n    # Schmidt and Stokes numbers\n    Sc = nu / D_diff\n    St = v_s * u_star / (g * A)\n\n    # Collection efficiencies\n    E_B = Sc^(-gamma_param)\n    E_IM = (St / (alpha + St))^2\n    E_IN = 0.5 * (D_p / A)^2\n    R_1 = exp(-sqrt(St))\n\n    return E_B, E_IM, E_IN, R_1\nend\n\nD_p_range = 10 .^ range(-2, 2, length = 100) .* 1e-6\n\nE_B_vals = Float64[]\nE_IM_vals = Float64[]\nE_IN_vals = Float64[]\nE_total_vals = Float64[]\n\nfor D_p in D_p_range\n    E_B, E_IM, E_IN, R_1 = collection_efficiencies(D_p)\n    push!(E_B_vals, E_B)\n    push!(E_IM_vals, E_IM)\n    push!(E_IN_vals, E_IN)\n    push!(E_total_vals, (E_B + E_IM + E_IN) * R_1)\nend\n\np = plot(\n    xlabel = \"Particle Diameter (micrometer)\",\n    ylabel = \"Collection Efficiency\",\n    title = \"Collection Efficiency Components (u* = 0.4 m/s, Grass)\",\n    xscale = :log10,\n    yscale = :log10,\n    xlims = (0.01, 100),\n    ylims = (1e-10, 1),\n    legend = :bottomright,\n    size = (700, 500),\n    grid = true\n)\n\nplot!(p, D_p_range .* 1e6, E_B_vals, label = \"E_B (Brownian)\", linewidth = 2, color = :blue)\nplot!(\n    p, D_p_range .* 1e6, E_IM_vals, label = \"E_IM (Impaction)\", linewidth = 2, color = :red)\nplot!(p, D_p_range .* 1e6, E_IN_vals,\n    label = \"E_IN (Interception)\", linewidth = 2, color = :green)\nplot!(p, D_p_range .* 1e6, E_total_vals, label = \"Total (with R_1)\",\n    linewidth = 3, color = :black, linestyle = :dash)\n\nsavefig(p, \"collection_efficiencies.png\")\np","category":"section"},{"location":"seinfeld_pandis_ch19/#Physical-Interpretation","page":"Seinfeld & Pandis Ch. 19","title":"Physical Interpretation","text":"Brownian diffusion (E_B): Dominates for particles smaller than ~0.1 micrometer. Decreases as D_p^2gamma3 approx D_p^036 for the Stokes-Einstein relation.\nImpaction (E_IM): Becomes significant for particles larger than ~1 micrometer. Depends on the Stokes number, which increases with D_p^2.\nInterception (E_IN): Also increases with particle size as D_p^2. Represents particles whose streamlines pass within one particle radius of the collector.\nSticking fraction (R_1): Reduces collection efficiency for large particles that may bounce off the surface.\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Sensitivity-to-Land-Use-Category","page":"Seinfeld & Pandis Ch. 19","title":"Sensitivity to Land-Use Category","text":"Different land-use categories have different characteristic collector radii (A) and collection efficiency parameters, leading to variations in deposition velocity.\n\nusing Plots\n\nconst k_B = 1.38e-23\nconst g = 9.81\nconst T = 298.0\nconst mu = 1.85e-5\nconst nu = 1.55e-5\nconst rho_p = 1000.0\nconst u_star = 0.4\nconst z = 10.0\nconst kappa = 0.4\n\n# Land-use parameters from Table 19.2\nlanduse_params = [\n    (\"Grass\", 2.0e-3, 1.2, 0.54, 0.1),\n    (\"Deciduous Forest\", 5.0e-3, 0.8, 0.56, 1.0),\n    (\"Desert\", 10.0e-3, 50.0, 0.54, 0.04)\n]\n\nfunction cunningham_correction(D_p)\n    lambda = 6.8e-8\n    Kn = 2 * lambda / D_p\n    return 1 + Kn * (1.257 + 0.4 * exp(-1.1 / Kn))\nend\n\nfunction particle_v_d(D_p, A, alpha, gamma_val, z_0)\n    C_c = cunningham_correction(D_p)\n    v_s = rho_p * D_p^2 * g * C_c / (18 * mu)\n    D_diff = k_B * T * C_c / (3 * pi * mu * D_p)\n\n    Sc = nu / D_diff\n    St = v_s * u_star / (g * A)\n\n    E_B = Sc^(-gamma_val)\n    E_IM = (St / (alpha + St))^2\n    E_IN = 0.5 * (D_p / A)^2\n    R_1 = exp(-sqrt(St))\n\n    r_b = 1 / (3 * u_star * (E_B + E_IM + E_IN) * R_1)\n    r_a = (1 / (kappa * u_star)) * log(z / z_0)\n\n    v_d = 1 / (r_a + r_b + r_a * r_b * v_s) + v_s\n    return v_d\nend\n\nD_p_range = 10 .^ range(-2, 2, length = 100) .* 1e-6\n\np = plot(\n    xlabel = \"Particle Diameter (micrometer)\",\n    ylabel = \"Deposition Velocity (cm/s)\",\n    title = \"Particle Deposition Velocity by Land-Use Category (u* = 0.4 m/s)\",\n    xscale = :log10,\n    yscale = :log10,\n    xlims = (0.01, 100),\n    ylims = (0.001, 10),\n    legend = :bottomright,\n    size = (700, 500),\n    grid = true\n)\n\ncolors = [:blue, :green, :orange]\nfor (i, (name, A, alpha, gamma_val, z_0)) in enumerate(landuse_params)\n    v_d_vals = [particle_v_d(D_p, A, alpha, gamma_val, z_0) * 100 for D_p in D_p_range]\n    plot!(p, D_p_range .* 1e6, v_d_vals, label = name, linewidth = 2, color = colors[i])\nend\n\nsavefig(p, \"landuse_comparison.png\")\np\n\n","category":"section"},{"location":"seinfeld_pandis_ch19/#Summary-Statistics","page":"Seinfeld & Pandis Ch. 19","title":"Summary Statistics","text":"The following table summarizes typical deposition velocities from the model compared to values from Table 19.1 in the textbook.\n\nusing DataFrames\n\n# Typical conditions\nu_star = 0.4  # m/s\nz = 10.0      # m\nz_0 = 0.1     # m (grass)\nkappa = 0.4\n\n# Aerodynamic resistance\nr_a = (1 / (kappa * u_star)) * log(z / z_0)\n\n# Quasi-laminar resistance (Sc ~ 1 for gases)\nr_b_gas = 5 * 1.0^(2/3) / u_star\n\n# Surface resistance estimates for different gases\n# Based on Table 19.1 measured values\ngases = [\n    (\"O3\", 0.4, 250 - r_a - r_b_gas),\n    (\"HNO3\", 4.0, 25 - r_a - r_b_gas),\n    (\"NO2\", 0.1, 1000 - r_a - r_b_gas),\n    (\"SO2\", 0.5, 200 - r_a - r_b_gas)\n]\n\ndf = DataFrame(\n    Gas = [g[1] for g in gases],\n    Measured_vd_cm_s = [g[2] for g in gases],\n    Implied_r_c_s_m = [max(0, g[3]) for g in gases],\n    r_a_s_m = fill(round(r_a, digits = 1), length(gases)),\n    r_b_s_m = fill(round(r_b_gas, digits = 1), length(gases))\n)\ndf\n\nThese results are consistent with the physical understanding that:\n\nHNO3 has very low surface resistance (highly soluble and reactive)\nO3 has moderate surface resistance (reactive but not very soluble)\nNO2 has high surface resistance\nSurface resistance dominates the total resistance for most gases\n","category":"section"},{"location":"seinfeld_pandis_ch19/#API-Reference","page":"Seinfeld & Pandis Ch. 19","title":"API Reference","text":"","category":"section"},{"location":"seinfeld_pandis_ch19/#Module","page":"Seinfeld & Pandis Ch. 19","title":"Module","text":"","category":"section"},{"location":"seinfeld_pandis_ch19/#Physical-Constants-2","page":"Seinfeld & Pandis Ch. 19","title":"Physical Constants","text":"","category":"section"},{"location":"seinfeld_pandis_ch19/#Data-Types","page":"Seinfeld & Pandis Ch. 19","title":"Data Types","text":"","category":"section"},{"location":"seinfeld_pandis_ch19/#Component-Functions","page":"Seinfeld & Pandis Ch. 19","title":"Component Functions","text":"","category":"section"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition","text":"DryDeposition\n\nModelingToolkit.jl implementation of dry deposition equations from: Seinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics, 2nd Edition, Chapter 19: Dry Deposition.\n\nThis module implements:\n\nGas deposition velocity using the resistance model (Eq. 19.2)\nParticle deposition velocity (Eq. 19.7)\nAerodynamic resistance (Eq. 19.14)\nQuasi-laminar resistance for gases (Eq. 19.17) and particles (Eq. 19.27)\nSurface resistance using Wesely (1989) model (Eq. 19.50)\n\n\n\n\n\n","category":"module"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.KAPPA","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.KAPPA","text":"Physical constants used throughout the dry deposition calculations.        # von Karman constant (dimensionless)\n\n\n\n\n\n","category":"constant"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.GasProperties","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.GasProperties","text":"Gas-specific properties from Table 19.4 for surface resistance calculations.\n\nFields:\n\nDratio: DH2O/D_gas ratio for diffusivity\nH_star: effective Henry's law constant (M/atm)\nf_0: reactivity factor (0-1)\n\n\n\n\n\n","category":"type"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.LandUseParameters","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.LandUseParameters","text":"Land-use dependent parameters from Table 19.2 (Zhang et al. 2001).\n\nFields:\n\nA: characteristic radius of collectors (m)\nalpha: parameter for impaction efficiency\ngamma: parameter for Brownian diffusion efficiency\n\n\n\n\n\n","category":"type"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.DryDepositionGas","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.DryDepositionGas","text":"DryDepositionGas(; name=:DryDepositionGas)\n\nComplete gas dry deposition velocity model using resistance approach.\n\nImplements Equation 19.2: vd = 1 / (ra + rb + rc)\n\nand Equation 19.1 for flux: F = -v_d * C\n\nComposes:\n\nAerodynamicResistance (Eq. 19.14)\nQuasiLaminarResistanceGas (Eq. 19.17)\nSurfaceResistance (Eq. 19.50-19.52)\n\nInputs (must be specified externally):\n\nu_star: Friction velocity (m/s)\nC: Gas concentration at reference height (mol/m^3)\nG: Solar irradiance at surface (W/m^2) - via surf subsystem\nT_s: Surface temperature (K) - via surf subsystem\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.DryDepositionParticle","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.DryDepositionParticle","text":"DryDepositionParticle(; name=:DryDepositionParticle)\n\nComplete particle dry deposition velocity model.\n\nImplements Equation 19.7: vd = 1/(ra + rb + rar_bvs) + vs\n\nand Equation 19.1 for flux: F = -v_d * C\n\nComposes:\n\nAerodynamicResistance (Eq. 19.14)\nParticleSettling (Eq. 19.18, 19.20)\nQuasiLaminarResistanceParticle (Eq. 19.27)\n\nInputs (must be specified externally):\n\nu_star: Friction velocity (m/s)\nC: Particle concentration at reference height (kg/m^3)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.AerodynamicResistance","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.AerodynamicResistance","text":"AerodynamicResistance(; name=:AerodynamicResistance)\n\nCalculates aerodynamic resistance for neutral stability conditions.\n\nImplements Equation 19.14: ra = (1/(kappa * ustar)) * ln(z/z_0)\n\nwhere:\n\nkappa = 0.4 (von Karman constant)\nu_star: friction velocity (m/s)\nz: reference height (m)\nz_0: roughness length (m)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceGas","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceGas","text":"QuasiLaminarResistanceGas(; name=:QuasiLaminarResistanceGas)\n\nCalculates quasi-laminar (boundary layer) resistance for gases.\n\nImplements Equation 19.17: rb = 5 * Sc^(2/3) / ustar\n\nwhere Sc = nu/D_g is the Schmidt number.\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceParticle","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceParticle","text":"QuasiLaminarResistanceParticle(; name=:QuasiLaminarResistanceParticle)\n\nCalculates quasi-laminar resistance for particles using Zhang et al. (2001) model.\n\nImplements Equation 19.27: rb = 1 / (3 * ustar * (EB + EIM + EIN) * R1)\n\nwhere:\n\nE_B = Sc^(-gamma) (Brownian diffusion, Eq. 19.21)\nE_IM = (St/(alpha + St))^2 (impaction, Eq. 19.22 with beta=2)\nEIN = 0.5 * (Dp/A)^2 (interception, Eq. 19.25)\nR_1 = exp(-sqrt(St)) (sticking fraction, Eq. 19.26)\nSt = vs * ustar / (g * A) (Stokes number, Eq. 19.24)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.ParticleSettling","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.ParticleSettling","text":"ParticleSettling(; name=:ParticleSettling)\n\nCalculates particle settling velocity and Brownian diffusivity.\n\nImplements:\n\nEquation 19.18 (Settling velocity): vs = rhop * Dp^2 * g * Cc / (18 * mu)\nEquation 19.20 (Brownian diffusivity): D = k * T * Cc / (3 * pi * mu * Dp)\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_ch19/#AtmosphericDeposition.DryDeposition.SurfaceResistance","page":"Seinfeld & Pandis Ch. 19","title":"AtmosphericDeposition.DryDeposition.SurfaceResistance","text":"SurfaceResistance(; name=:SurfaceResistance)\n\nCalculates surface (canopy) resistance for gases using Wesely (1989) model.\n\nImplements Equation 19.50: rc = (1/(rst + rm) + 1/rlu + 1/(rdc + rcl) + 1/(rac + rgs))^(-1)\n\nand component resistances:\n\nEq. 19.51: Stomatal resistance rst = ri * [1 + (200/(G+0.1))^2] * [400/(Ts*(40-Ts))]\nEq. 19.52: Mesophyll resistance rm = 1 / (3.3e-4 * Hstar + 100 * f_0)\n\nNote: The stomatal resistance formula uses empirical coefficients with implicit units. Temperature T_s is expected in Celsius (valid range: 0-40C for the formula). Solar irradiance G is expected in W/m^2.\n\n\n\n\n\n","category":"function"},{"location":"emep/#EMEP-Wet-Deposition-Algorithm","page":"EMEP","title":"EMEP Wet Deposition Algorithm","text":"","category":"section"},{"location":"emep/#Model","page":"EMEP","title":"Model","text":"This is an implementation of a box model used to calculate wet deposition based on formulas at Unified EMEP Model documentation, chapter 9.","category":"section"},{"location":"emep/#Running-the-model","page":"EMEP","title":"Running the model","text":"using AtmosphericDeposition\nusing ModelingToolkit\nusing DifferentialEquations\nusing EarthSciMLBase\nusing DynamicQuantities\nusing ModelingToolkit: t\n\nmodel = WetDeposition()\n\nBefore running any simulations with the model we need to convert it into a system of differential equations.\n\nsys = structural_simplify(model)\ntspan = (0.0, 3600*24)\nu0 = [2.0, 10.0, 5, 1400, 275, 50, 0.15, 2.34, 10, 0.15]  # initial concentration of SO₂, O₃, NO₂, CH₄, CO, DMS, ISOP, H₂O₂, HNO₃, CH₂O\nprob = ODEProblem(sys, u0, tspan, [])\nsol = solve(prob, AutoTsit5(Rosenbrock23()), saveat = 10.0) # default parameters\n\nwhich we can plot as\n\nusing Plots\nplot(sol, xlabel = \"Time (second)\", ylabel = \"concentration (ppb)\", legend = :outerright)","category":"section"},{"location":"emep/#Parameters","page":"EMEP","title":"Parameters","text":"The parameters in the model are:\n\nparameters(sys) #[ρ_air, qrain, Δz, cloudFrac]\n\nwhere cloudFrac is fraction of grid cell covered by clouds, qrain is rain mixing ratio, ρ_air is air density [kg/m3], and Δz is fall distance [m].\n\nLet's run some simulation with different value for parameter cloudFrac.\n\n@unpack O3, cloudFrac, qrain = sys\n\np1 = [cloudFrac=>0.3]\np2 = [cloudFrac=>0.6]\nsol1 = solve(ODEProblem(sys, [], tspan, p1), AutoTsit5(Rosenbrock23()), saveat = 10.0)\nsol2 = solve(ODEProblem(sys, [], tspan, p2), AutoTsit5(Rosenbrock23()), saveat = 10.0)\n\nplot([sol1[O3], sol2[O3]], label = [\"cloudFrac=0.3\" \"cloudFrac=0.6\"],\n    title = \"Change of O3 concentration due to wet deposition\",\n    xlabel = \"Time (second)\", ylabel = \"concentration (ppb)\")\n\nFrom the plot we could see that with larger cloud fraction, the wet deposition rate increases.\n\nLet's run some simulation with different value for parameter qrain\n\np3 = [qrain=>0.3]\np4 = [qrain=>0.6]\nsol3 = solve(ODEProblem(sys, [], tspan, p3), AutoTsit5(Rosenbrock23()), saveat = 10.0)\nsol4 = solve(ODEProblem(sys, [], tspan, p4), AutoTsit5(Rosenbrock23()), saveat = 10.0)\n\nplot([sol3[O3], sol4[O3]], label = [\"qrain=0.3\" \"qrain=0.6\"],\n    title = \"Change of O3 concentration due to wet deposition\",\n    xlabel = \"Time (second)\", ylabel = \"concentration (ppb)\")\n\nThe graph indicates that an increase in the rain mixing ratio leads to a corresponding rise in the rate of wet deposition.","category":"section"},{"location":"dry_deposition/#Dry-Deposition","page":"Overview","title":"Dry Deposition","text":"","category":"section"},{"location":"dry_deposition/#Model","page":"Overview","title":"Model","text":"This is an implementation of a box model used to calculate changes in gas species concentration due to dry deposition.","category":"section"},{"location":"dry_deposition/#Running-the-model","page":"Overview","title":"Running the model","text":"Here's an example of how concentration of different species, such as SO₂, O₃, NO₂, NO, H₂O₂, CH₂O and HNO₃change due to dry deposition.\n\nWe can create an instance of the model in the following manner:\n\nusing AtmosphericDeposition\nusing ModelingToolkit\nusing DifferentialEquations\nusing EarthSciMLBase\nusing DynamicQuantities\nusing ModelingToolkit: t\n\nmodel = DryDepositionGas()\n\nBefore running any simulations with the model we need to convert it into a system of differential equations.\n\nsys = structural_simplify(model)\ntspan = (0.0, 3600*24)\nprob = ODEProblem(sys, [], tspan, []) # default initial concentration of SO₂, O₃, NO₂, H₂O₂, HNO₃, CH₂O\nsol = solve(prob, AutoTsit5(Rosenbrock23()), saveat = 10.0) # default parameters\n\nwhich we can plot as\n\nusing Plots\nplot(sol, xlabel = \"Time (second)\", ylabel = \"concentration (ppb)\", legend = :outerright)","category":"section"},{"location":"dry_deposition/#Parameters","page":"Overview","title":"Parameters","text":"The parameters in the model are:\n\nparameters(sys) # [iLandUse, z, z₀, u_star, L, ρA, G, iSeason, T, θ]\n\nwhere iLandUse is the index for the landuse, iSeason is the index for the season, z is the top of the surface layer [m], z₀ is the roughness length [m], u_star is friction velocity [m/s], and L is Monin-Obukhov length [m], ρA is air density [kg/m3], T is surface air temperature [K], G is solar irradiation [W m-2], Θ is the slope of the local terrain [radians].\n\nLet's run some simulation with different value for parameter z.\n\n@unpack O3, z = sys\n\np1 = [z=>50]\np2 = [z=>10]\nsol1 = solve(ODEProblem(sys, [], tspan, p1), AutoTsit5(Rosenbrock23()), saveat = 10.0)\nsol2 = solve(ODEProblem(sys, [], tspan, p2), AutoTsit5(Rosenbrock23()), saveat = 10.0)\n\nplot([sol1[O3], sol2[O3]], label = [\"z=50m\" \"z=10m\"],\n    title = \"Change of O3 concentration due to dry deposition\",\n    xlabel = \"Time (second)\", ylabel = \"concentration (ppb)\")","category":"section"},{"location":"wesley1989/#Wesley-1989-Dry-Deposition-Surface-Resistance","page":"Wesley","title":"Wesley 1989 Dry Deposition Surface Resistance","text":"","category":"section"},{"location":"wesley1989/#Introduction","page":"Wesley","title":"Introduction","text":"This is the Wesely 1989 algorithm for surface resistance to dry deposition.\n\nCitation for the original article, followed by citation for an article with some corrections which have been incorporated here:\n\nM. L. Wesely, Parameterization of surface resistances to gaseous dry deposition in regional-scale numerical models, Atmos. Environ. 23, 1293–1304 (1989), http://dx.doi.org/10.1016/0004-6981(89)90153-4.\nJ. Walmsley, and M. L. Wesely, Modification of coded parametrizations of surface resistances to gaseous dry deposition, Atmos. Environ. 30(7), 1181–1188 (1996), http://dx.doi.org/10.1016/1352-2310(95)00403-3.\n\nThe abstract of the original article:\n\nMethods for estimating the dry deposition velocities of atmospheric gases in the U.S. and surrounding areas have been improved and incorporated into a revised computer code module for use in numerical models of atmospheric transport and deposition of pollutants over regional scales. The key improvement is the computation of bulk surface resistances along three distinct pathways of mass transfer to sites of deposition at the upper portions of vegetative canopies or structures, the lower portions, and the ground (or water surface). This approach replaces the previous technique of providing simple look-up tables of bulk surface resistances. With the surface resistances divided explicitly into distinct pathways, the bulk surface resistances for a large number of gases in addition to those usually addressed in acid deposition models (SO₂, O₃, NOₓ, and HNO₃) can be computed, if estimates of the effective Henry’s Law constants and appropriate measures of the chemical reactivity of the various substances are known. This has been accomplished successfully for H₂O₂, HCHO, CH₃O₂H (to represent organic peroxides), CH₃C(O)O₂H, HCOOH (to represent organic acids), NH₃, CH₃C(O)O₂NO₂, and HNO₂. Other factors considered include surface temperature, stomatal response to environmental parameters, the wetting of surfaces by dew and rain, and the covering of surfaces by snow. Surface emission of gases and variations of uptake characteristics by individual plant species within the land use types are not considered explicitly.","category":"section"},{"location":"wesley1989/#Main-functions","page":"Wesley","title":"Main functions","text":"Function WesleySurfaceResistance is used to calculate surface resistance to dry depostion [s/m] based on Wesely (1989) equation 2. The inputs of the function are information on the chemical of interest gasData, solar irradiation G [W/m²], the surface air temperature Ts [°C], the slope of the local terrain Θ [radians], the season index iSeason, the land use index iLandUse, whether there is currently rain or dew rain or dew, and whether the chemical of interest is either SO₂ isSO2 or O₃ isO3. Here's an example:\n\ngasData::GasData = AtmosphericDeposition.So2Data\nG, Ts, θ = [1.0, 20.0, 1.0] # [W/m², °C, radians]\niSeason, iLandUse = [1, 1] # the season index and land use index need to be integers\nrain::Bool, dew::Bool, isSO2::Bool, isO3::Bool = [true, true, true, false]\n\nWesleySurfaceResistance(gasData, G, Ts, θ, iSeason, iLandUse, rain, dew, isSO2, isO3) # [s/m]\n\nThis will return you the value of surface resistance to dry deposition of SO₂ with given solar irradiation, temperature and local terrain during midsummer with lush vegetation (season) in areas of evergreen needleleaf trees (land).","category":"section"},{"location":"wesley1989/#Default-parameters","page":"Wesley","title":"Default parameters","text":"a. For season index iSeason, there're five seasonal categories\n\n1. Midsummer with lush vegetation\n2. Autumn with cropland not harvested\n3. Late autumn after frost, no snow\n4. Winter, snow on ground\n5. Transitional\n\nb. For land use index iLandUse, there're eleven land use categories\n\n1. Urban land \n2. agricultural land\n3. range land\n4. deciduous forest\n5. coniferous forest \n6. mixed forest including wetland \n7. water, both salt and fresh \n8. barren land, mostly desert\n9. nonforested wetland\n10. mixed agricultural and range land\n11. rocky open areas with low-growing shrubs\n\nc. For gasData gasData, we include the following species:\n\nVariable name Species\nSo2Data SO2\nO3Data O3\nNo2Data NO2\nNoData NO\nHno3Data HNO3\nH2o2Data H2O2\nAldData Acetaldehyde (aldehyde class)\nHchoData Formaldehyde\nOpData Methyl hydroperoxide (organic peroxide class)\nPaaData Peroxyacetyl nitrate\nOraData Formic acid (organic acid class)\nNh3Data NH3\nPanData Peroxyacetyl nitrate\nHno2Data Nitrous acid\n\nWesely (1989) suggests that, in general, the sum of NO and NO₂ should be considered rather than NO₂ alone because rapid in-air chemical reactions can cause a significant change of NO and NO₂ vertical fluxes between the surface and the point at which deposition velocities are applied, but the sum of NO and NO₂ fluxes should be practically unchanged.","category":"section"},{"location":"#AtmosphericDeposition","page":"Home","title":"AtmosphericDeposition","text":"Documentation for AtmosphericDeposition.\n\n","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Wet-Deposition-(Seinfeld-and-Pandis,-2006)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Wet Deposition (Seinfeld & Pandis, 2006)","text":"","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Overview","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Overview","text":"This module implements the wet deposition equations from Chapter 20 of Seinfeld and Pandis (2006), covering below-cloud scavenging of gases and particles, and associated scavenging coefficients.\n\nWet deposition is a major pathway for removing trace gases and aerosol particles from the atmosphere. The implemented equations describe:\n\nGas-phase mass transfer to falling raindrops via the Sherwood number correlation\nIrreversible gas scavenging for highly soluble species (e.g., HNO₃)\nReversible gas scavenging retaining equilibrium (Henry's law) effects\nParticle scavenging via the Slinn (1983) semi-empirical collision efficiency\nWet deposition flux and deposition velocity\n\nReference: Seinfeld, J. H. and Pandis, S. N. (2006). Atmospheric Chemistry and Physics: From Air Pollution to Climate Change, 2nd ed., Chapter 20: Wet Deposition, pp. 932–979. John Wiley & Sons, Inc.","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Implementation","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Implementation","text":"","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Mass-Transfer-Coefficient-(Eq.-20.12)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Mass Transfer Coefficient (Eq. 20.12)","text":"The mass transfer coefficient K_c for gas absorption by a spherical raindrop is computed from the Sherwood number correlation:\n\nK_c = fracD_gD_pleft2 + 06textRe^12textSc^13right\n\nwhere textRe = rho_textair U_t D_p  mu_textair and textSc = mu_textair  (rho_textair D_g).\n\nusing AtmosphericDeposition\nusing ModelingToolkit\nusing DataFrames, Symbolics, DynamicQuantities\n\nsys = MassTransferCoeff()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Gas-Scavenging-Coefficient-(Eq.-20.25)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Gas Scavenging Coefficient (Eq. 20.25)","text":"For irreversible uptake by monodisperse drops:\n\nLambda = frac6p_0K_cD_pU_t\n\nsys = GasScavengingCoeff()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Particle-Collection-Efficiency-(Eq.-20.53)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Particle Collection Efficiency (Eq. 20.53)","text":"The Slinn (1983) semi-empirical correlation computes the collection efficiency E as a sum of three terms: Brownian diffusion, interception, and inertial impaction.\n\nsys = ParticleCollectionEfficiency()\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Equations","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Equations","text":"sys = BelowCloudGasScavenging()\nequations(sys)","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Analysis","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Analysis","text":"","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Table-20.1:-Estimation-of-the-Scavenging-Coefficient-Λ-for-Irreversible-Scavenging","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Table 20.1: Estimation of the Scavenging Coefficient Λ for Irreversible Scavenging","text":"Table 20.1 from Seinfeld & Pandis (2006, p. 941) shows the scavenging coefficient Λ for irreversible gas scavenging in a homogeneous atmosphere with precipitation rate p_0 = 1 mm h⁻¹.\n\nD_p (cm) U_t (cm s⁻¹) K_c (cm s⁻¹) Λ (h⁻¹) 1Λ (h)\n0.001 0.3 220 4.4 × 10⁵ 2.3 × 10⁻⁶\n0.01 26 32 73.8 0.01\n0.1 300 13 0.26 3.8\n1.0 1000 6 0.0036 278\n\nThe table demonstrates that the scavenging coefficient depends dramatically on raindrop diameter. Very small drops are very efficient in scavenging soluble gases for two reasons: (1) they fall more slowly, so they have more time in their transit to \"clean\" the atmosphere; and (2) mass transfer is more efficient for these drops (high K_c). Note that the scavenging rate varies over eight orders of magnitude when the drop diameter increases by three orders. Also note that the scavenging time scale (1Λ) can vary from less than a second to several hours depending on the raindrop size distribution.","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Computed-Table-20.1:-Gas-Scavenging-Coefficient-Comparison","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Computed Table 20.1: Gas Scavenging Coefficient Comparison","text":"Validation against Table 20.1 in Seinfeld & Pandis (2006). This table compares computed values against the textbook reference values for p_0 = 1 mm/h.\n\nusing AtmosphericDeposition: mass_transfer_coeff, gas_scavenging_coeff,\n                             μ_air_sp, ρ_air_sp\nusing ModelingToolkit\nusing DataFrames\nusing DynamicQuantities\nusing Symbolics\n\n@parameters D_g_val = 1.26e-5 [unit = u\"m^2/s\"]\n@parameters D_p_val [unit = u\"m\"]\n@parameters U_t_val [unit = u\"m/s\"]\n@parameters p₀_val = 2.778e-7 [unit = u\"m/s\"]\n\ndefaults = [μ_air_sp => 1.72e-5, ρ_air_sp => 1.225]\n\n# Table 20.1 data (Seinfeld & Pandis 2006, p. 941):\n# D_p (m), U_t (m/s), K_c from table (m/s), Λ from table (h⁻¹)\n# Note: Original table uses cm and cm/s; converted to SI units here\ntable_data = [\n    (1e-5, 0.003, 2.20, 4.4e5),   # D_p = 0.001 cm, U_t = 0.3 cm/s, K_c = 220 cm/s\n    (1e-4, 0.26, 0.32, 73.8),    # D_p = 0.01 cm, U_t = 26 cm/s, K_c = 32 cm/s\n    (1e-3, 3.00, 0.13, 0.26),    # D_p = 0.1 cm, U_t = 300 cm/s, K_c = 13 cm/s\n    (1e-2, 10.00, 0.06, 0.0036)  # D_p = 1.0 cm, U_t = 1000 cm/s, K_c = 6 cm/s\n]\n\nKc_expr = mass_transfer_coeff(D_g_val, D_p_val, U_t_val)\nΛ_expr = gas_scavenging_coeff(Kc_expr, U_t_val, D_p_val, p₀_val)\n\nresults = DataFrame(\n    D_p_cm = Float64[],\n    U_t_cms = Float64[],\n    K_c_table_cms = Float64[],\n    K_c_computed_cms = Float64[],\n    Λ_table_h = Float64[],\n    Λ_computed_h = Float64[],\n    rel_error_pct = Float64[]\n)\n\nfor (dp, ut, kc_table, lam_table) in table_data\n    Kc_val = Symbolics.value(substitute(Kc_expr,\n        Dict(D_g_val => 1.26e-5, D_p_val => dp, U_t_val => ut, defaults...)))\n    Λ_val = Symbolics.value(substitute(Λ_expr,\n        Dict(D_g_val => 1.26e-5, D_p_val => dp, U_t_val => ut,\n            p₀_val => 2.778e-7, defaults...)))\n    Kc_computed_cms = Float64(Kc_val) * 100  # m/s → cm/s\n    Λ_computed_h = Float64(Λ_val) * 3600     # s⁻¹ → h⁻¹\n    rel_err = abs(Λ_computed_h - lam_table) / lam_table * 100\n    push!(results, (\n        dp * 100, ut * 100, kc_table, Kc_computed_cms, lam_table, Λ_computed_h, rel_err))\nend\n\nresults","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Gas-Scavenging-Coefficient-vs.-Raindrop-Diameter-Plot","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Gas Scavenging Coefficient vs. Raindrop Diameter Plot","text":"The scavenging coefficient Lambda as a function of raindrop diameter for p_0 = 1 mm/h.\n\nusing Plots\n\nplot(results.D_p_cm, results.Λ_computed_h, yscale = :log10, xscale = :log10,\n    marker = :circle, label = \"Computed\",\n    xlabel = \"Drop diameter (cm)\", ylabel = \"Λ (h⁻¹)\",\n    title = \"Gas Scavenging Coefficient (Table 20.1)\")\nscatter!(results.D_p_cm, results.Λ_table_h, marker = :square, label = \"Table 20.1\")","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Below-Cloud-Gas-Concentration-Decay-(Eq.-20.24)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Below-Cloud Gas Concentration Decay (Eq. 20.24)","text":"Exponential decay of gas-phase concentration due to irreversible scavenging at different scavenging coefficients.\n\nusing OrdinaryDiffEqDefault\n\nsys = BelowCloudGasScavenging()\ncompiled = mtkcompile(sys)\n\nC_g0 = 1e-5\ntspan = (0.0, 3600.0 * 5) # 5 hours\n\nΛ_values = [0.26 / 3600, 1.0 / 3600, 3.3 / 3600] # h⁻¹ → s⁻¹\nlabels = [\"Λ = 0.26 h⁻¹\" \"Λ = 1.0 h⁻¹\" \"Λ = 3.3 h⁻¹\"]\n\np = plot(xlabel = \"Time (hours)\", ylabel = \"C_g / C_g₀\",\n    title = \"Below-Cloud Gas Scavenging (Eq. 20.24)\")\n\nfor (i, Λ_val) in enumerate(Λ_values)\n    # Back-calculate p₀ from Λ = 6*p₀*K_c/(D_p*U_t) with K_c=0.13, D_p=1e-3, U_t=3\n    p₀_val = Λ_val * 1e-3 * 3.0 / (6 * 0.13)\n    prob = ODEProblem(compiled,\n        merge(Dict(compiled.C_g => C_g0),\n            Dict(compiled.K_c => 0.13, compiled.U_t => 3.0, compiled.D_p => 1e-3,\n                compiled.h => 1000.0, compiled.p₀ => p₀_val)),\n        tspan)\n    sol = solve(prob)\n    plot!(p, sol.t ./ 3600, sol[compiled.C_g] ./ C_g0,\n        label = labels[i])\nend\np","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Collection-Efficiency-vs.-Particle-Size-(Figure-20.6)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Collection Efficiency vs. Particle Size (Figure 20.6)","text":"The Slinn (1983) collision efficiency as a function of collected particle radius, showing the Brownian diffusion regime at small sizes, the Greenfield gap near 1 μm, and the inertial impaction regime at large sizes.\n\nusing AtmosphericDeposition: slinn_collection_efficiency\nusing DynamicQuantities\nusing Symbolics\n\n@parameters D_p_rain [unit = u\"m\"]\n@parameters U_t_rain [unit = u\"m/s\"]\n@parameters d_p_aer [unit = u\"m\"]\n@parameters ρ_p_aer [unit = u\"kg/m^3\"]\n@parameters T_val [unit = u\"K\"]\n\nE_expr = slinn_collection_efficiency(D_p_rain, U_t_rain, d_p_aer, ρ_p_aer, T_val)\n\ndefaults_E = [μ_air_sp => 1.72e-5, ρ_air_sp => 1.225, AtmosphericDeposition.μ_w_sp => 1e-3,\n    AtmosphericDeposition.ρ_w_sp => 1000.0, AtmosphericDeposition.g_sp => 9.81,\n    AtmosphericDeposition.kB_sp => 1.3806488e-23]\n\n# Two collector drop sizes: radius = 0.1 mm (D_p = 0.2 mm) and 1 mm (D_p = 2 mm)\ndrop_configs = [\n    (2e-4, 0.8, \"r = 0.1 mm\"),    # D_p = 0.2 mm, U_t ≈ 0.8 m/s\n    (2e-3, 6.5, \"r = 1.0 mm\")    # D_p = 2 mm, U_t ≈ 6.5 m/s\n]\n\n# Particle radii from 0.001 to 10 μm\nparticle_radii = 10 .^ range(-3, 1, length = 50) .* 1e-6  # in meters (radii)\nparticle_diameters = 2 .* particle_radii\n\np = plot(xscale = :log10, yscale = :log10,\n    xlabel = \"Particle radius (μm)\", ylabel = \"Collection efficiency E\",\n    title = \"Slinn Collision Efficiency (Fig. 20.6)\",\n    ylim = (1e-5, 1.0))\n\nfor (Dp, Ut, lbl) in drop_configs\n    E_vals = Float64[]\n    for dp in particle_diameters\n        E_val = Symbolics.value(substitute(E_expr,\n            Dict(D_p_rain => Dp, U_t_rain => Ut, d_p_aer => dp,\n                ρ_p_aer => 1000.0, T_val => 298.0, defaults_E...)))\n        push!(E_vals, max(Float64(E_val), 1e-10))\n    end\n    plot!(p, particle_radii .* 1e6, E_vals, label = lbl)\nend\np","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#Particle-Scavenging-Coefficient-vs.-Particle-Size-(Figure-20.7)","page":"Seinfeld & Pandis (2006) Ch. 20","title":"Particle Scavenging Coefficient vs. Particle Size (Figure 20.7)","text":"The scavenging coefficient Lambda for monodisperse particles collected by monodisperse raindrops (Eq. 20.57), as a function of particle diameter for raindrop diameters of 0.2 and 2 mm assuming a rainfall intensity of p_0 = 1 mm h⁻¹.\n\nusing AtmosphericDeposition: slinn_collection_efficiency, particle_scavenging_coeff\n\n# Raindrop configurations: (D_p [m], U_t [m/s], label)\ndrop_configs_scav = [\n    (2e-4, 0.8, \"D_p = 0.2 mm\"),   # 0.2 mm diameter drop\n    (2e-3, 6.5, \"D_p = 2 mm\")     # 2 mm diameter drop\n]\n\n# Particle diameters from 0.001 to 10 μm\nparticle_diams = 10 .^ range(-3, 1, length = 50) .* 1e-6  # in meters\n\n# p₀ = 1 mm/h = 2.778e-7 m/s\np₀_val_scav = 2.778e-7\n\np_scav = plot(xscale = :log10, yscale = :log10,\n    xlabel = \"Particle diameter (μm)\", ylabel = \"Λ (h⁻¹)\",\n    title = \"Particle Scavenging Coefficient (Fig. 20.7)\",\n    ylim = (1e-4, 10.0))\n\nfor (Dp, Ut, lbl) in drop_configs_scav\n    Λ_vals = Float64[]\n    for dp in particle_diams\n        E_val = Symbolics.value(substitute(E_expr,\n            Dict(D_p_rain => Dp, U_t_rain => Ut, d_p_aer => dp,\n                ρ_p_aer => 1000.0, T_val => 298.0, defaults_E...)))\n        # Λ = (3/2) * E * p₀ / D_p  (Eq. 20.57)\n        Λ_si = 1.5 * max(Float64(E_val), 1e-20) * p₀_val_scav / Dp\n        Λ_h = Λ_si * 3600  # convert s⁻¹ to h⁻¹\n        push!(Λ_vals, Λ_h)\n    end\n    plot!(p_scav, particle_diams .* 1e6, Λ_vals, label = lbl)\nend\np_scav","category":"section"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.MassTransferCoeff","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.MassTransferCoeff","text":"MassTransferCoeff(; name = :MassTransferCoeff)\n\nModelingToolkit component for the gas-phase mass transfer coefficient to a raindrop (Eq. 20.12, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.GasScavengingCoeff","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.GasScavengingCoeff","text":"GasScavengingCoeff(; name = :GasScavengingCoeff)\n\nModelingToolkit component for the irreversible gas scavenging coefficient (Eq. 20.25, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.ReversibleGasScavenging","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.ReversibleGasScavenging","text":"ReversibleGasScavenging(; name = :ReversibleGasScavenging)\n\nModelingToolkit component for reversible below-cloud gas scavenging (Eqs. 20.28, 20.33, 20.35, Seinfeld & Pandis, 2006).\n\nThe parameter HRT is the dimensionless product H* × R × T × 1000 (effective Henry's law coefficient × gas constant × temperature × unit conversion). For HNO₃ at 298 K: HRT = 2.1e5 × 8.206e-5 × 298 × 1000 ≈ 5.14e6.\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.BelowCloudGasScavenging","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.BelowCloudGasScavenging","text":"BelowCloudGasScavenging(; name = :BelowCloudGasScavenging)\n\nModelingToolkit component for irreversible below-cloud gas scavenging. Computes the scavenging coefficient (Eq. 20.25), the below-cloud flux (Eq. 20.22), and the exponential gas concentration decay (Eq. 20.24).\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.ParticleCollectionEfficiency","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.ParticleCollectionEfficiency","text":"ParticleCollectionEfficiency(; name = :ParticleCollectionEfficiency)\n\nModelingToolkit component for the Slinn (1983) semi-empirical particle-drop collision (collection) efficiency (Eq. 20.53–20.54, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.ParticleScavengingCoeff","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.ParticleScavengingCoeff","text":"ParticleScavengingCoeff(; name = :ParticleScavengingCoeff)\n\nModelingToolkit component for the particle scavenging coefficient with monodisperse raindrops (Eq. 20.57, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"function"},{"location":"seinfeld_pandis_2006_ch20/#AtmosphericDeposition.WetDepositionFlux","page":"Seinfeld & Pandis (2006) Ch. 20","title":"AtmosphericDeposition.WetDepositionFlux","text":"WetDepositionFlux(; name = :WetDepositionFlux)\n\nModelingToolkit component for the net wet deposition flux and velocity (Eqs. 20.7–20.9, Seinfeld & Pandis, 2006).\n\n\n\n\n\n","category":"function"}]
}
