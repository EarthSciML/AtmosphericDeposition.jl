var documenterSearchIndex = {"docs":
[{"location":"api/#Index","page":"API","title":"Index","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"","category":"page"},{"location":"api/#API-Documentation","page":"API","title":"API Documentation","text":"","category":"section"},{"location":"api/","page":"API","title":"API","text":"Modules = [AtmosphericDeposition]","category":"page"},{"location":"api/#AtmosphericDeposition.z₀_table","page":"API","title":"AtmosphericDeposition.z₀_table","text":"Values for the characteristic radii of collectors [m] where the columns are land use categories and the rows are seasonal categories. Land-use categories (LUCs)\n\nEvergreen–needleleaf trees\nDeciduous broadleaf trees\nGrass\nDesert\nShrubs and interrupted woodlands\n\nSeasonal categories (SC)\n\nMidsummer with lush vegetation\nAutumn with cropland not harvested\nLate autumn after frost, no snow\nWinter, snow on ground\nTransitional\n\ngiven in Seinfeld and Pandis Table 19.2\n\n\n\n\n\n","category":"constant"},{"location":"api/#AtmosphericDeposition.DrydepositionG","page":"API","title":"AtmosphericDeposition.DrydepositionG","text":"Description: This is a box model used to calculate the gas species concentration rate changed by dry deposition. Build Drydeposition model (gas)\n\nExample\n\n\t@parameters t \n\td = DrydepositionG(t)\n\n\n\n\n\n","category":"type"},{"location":"api/#AtmosphericDeposition.Wetdeposition","page":"API","title":"AtmosphericDeposition.Wetdeposition","text":"Description: This is a box model used to calculate wet deposition based on formulas at EMEP model. Build Wetdeposition model\n\nExample\n\n\t@parameters t \n\twd = Wetdeposition(t)\n\n\n\n\n\n","category":"type"},{"location":"api/#AtmosphericDeposition.DryDepGas-Tuple{Any, Any, Any, Any, Any, AtmosphericDeposition.GasData, Any, Any, Any, Int64, Int64, Vararg{Bool, 4}}","page":"API","title":"AtmosphericDeposition.DryDepGas","text":"Function DryDepGas calculates dry deposition velocity [m/s] for a gas species, where z is the height of the surface layer [m], zo is roughness length [m], u_star is friction velocity [m/s],  L is Monin-Obukhov length [m], T is surface air temperature [K], ρA is air density [kg/m3] gasData is data about the gas species for surface resistance calculations, G is solar irradiation [W m-2], Θ is the slope of the local terrain [radians], iSeason and iLandUse are indexes for the season and land use, dew and rain indicate whether there is dew or rain on the ground, and isSO2 and isO3 indicate whether the gas species of interest is either SO2 or O3, respectively.  Based on Seinfeld and Pandis (2006) equation 19.2.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.DryDepParticle-Tuple{Any, Any, Any, Any, Any, Any, Any, Any, Any, Int64, Int64}","page":"API","title":"AtmosphericDeposition.DryDepParticle","text":"Function DryDepParticle calculates particle dry deposition velocity [m/s] where z is the height of the surface layer [m], zo is roughness length [m], u_star is friction velocity [m/s], L is Monin-Obukhov length [m],  Dp is particle diameter [m], Ts is surface air temperature [K], P is pressure [Pa], ρParticle is particle density [kg/m3], ρAir is air density [kg/m3], and iSeason and iLandUse are indexes for the season and land use. Based on Seinfeld and Pandis (2006) equation 19.7.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.RbGas-Tuple{Any, Any}","page":"API","title":"AtmosphericDeposition.RbGas","text":"Function RbGas calculates the quasi-laminar sublayer resistance to dry deposition for a gas species [s/m], where Sc is the dimensionless Schmidt number and u_star is the friction velocity [m/s].  From Seinfeld and Pandis (2006) equation 19.17.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.RbParticle-Tuple{Any, Any, Any, Any, Int64, Int64}","page":"API","title":"AtmosphericDeposition.RbParticle","text":"Function RbParticle calculates the quasi-laminar sublayer resistance to dry deposition for a particles [s/m], where Sc is the dimensionless Schmidt number, u_star is the friction velocity [m/s], St is the dimensionless Stokes number,  Dp is particle diameter [m], and iSeason and iLandUse are season and land use indexes, respectively. From Seinfeld and Pandis (2006) equation 19.27.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.WetDeposition-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.WetDeposition","text":"Calculate wet deposition based on formulas at https://www.emep.int/publ/reports/2003/emepreport1part12003.pdf. Inputs are fraction of grid cell covered by clouds (cloudFrac), rain mixing ratio (qrain), air density (ρ_air [kg/m3]), and fall distance (Δz [m]). Outputs are wet deposition rates for PM2.5, SO2, and other gases (wdParticle, wdSO2, and wdOtherGas [1/s]).\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.cc-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.cc","text":"Function cc calculates the Cunnningham slip correction factor where Dp is particle diameter [m], T is temperature [K], and P is pressure [Pa]. From Seinfeld and Pandis (2006) equation 9.34.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.dH2O-Tuple{Any}","page":"API","title":"AtmosphericDeposition.dH2O","text":"Function dH2O calculates molecular diffusivity of water vapor in air [m2/s] where T is temperature [K] using a regression fit to data in Bolz and Tuve (1976) found here: http://www.cambridge.org/us/engineering/author/nellisandklein/downloads/examples/EXAMPLE_9.2-1.pdf\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.dParticle-NTuple{5, Any}","page":"API","title":"AtmosphericDeposition.dParticle","text":"Function dParticle calculates the brownian diffusivity of a particle [m2/s] using the Stokes-Einstein-Sutherland relation (Seinfeld and Pandis eq. 9.73)  where T is air temperature [K], P is pressure [Pa], Dp is particle diameter [m], and μ is air dynamic viscosity [kg/(s m)]\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.mfp-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.mfp","text":"Function mfp calculates the mean free path of air [m]  where T is temperature [K] P is pressure [Pa], and Mu is dynamic viscosity [kg/(m s)]. From Seinfeld and Pandis (2006) equation 9.6\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.mu-Tuple{Any}","page":"API","title":"AtmosphericDeposition.mu","text":"Function mu calculates the dynamic viscosity of air [kg m-1 s-1] where T is temperature [K].\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.ra-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.ra","text":"Function Ra calculates aerodynamic resistance to dry deposition  where z is the top of the surface layer [m], z₀ is the roughness length [m], u_star is friction velocity [m/s], and L is Monin-Obukhov length [m] Based on Seinfeld and Pandis (2006) [Seinfeld, J.H. and Pandis, S.N. (2006) Atmospheric Chemistry and Physics: From Air Pollution to Climate Change. 2nd Edition, John Wiley & Sons, New York.]  equation 19.13 & 19.14.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.sc-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.sc","text":"Function sc computes the dimensionless Schmidt number, where μ is dynamic viscosity of air [kg/(s m)], ρ is air density [kg/m3], and D is the molecular diffusivity of the gas speciesof interest [m2/s]\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.stSmooth-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.stSmooth","text":"Function stSmooth computes the dimensionless Stokes number for dry deposition of particles on smooth surfaces or surfaces with bluff roughness elements,  where vs is settling velocity [m/s], u_star is friction velocity [m/s], μ is dynamic viscosity of air [kg/(s m)], and ρ is air density [kg/m3],  based on Seinfeld and Pandis (2006) equation 19.23.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.stVeg-Tuple{Any, Any, Any}","page":"API","title":"AtmosphericDeposition.stVeg","text":"Function stVeg computes the dimensionless Stokes number for dry deposition of particles on vegetated surfaces,  where vs is settling velocity [m/s], u_star is friction velocity [m/s], and A is the characteristic collector radius [m], based on Seinfeld and Pandis (2006) equation 19.24.\n\n\n\n\n\n","category":"method"},{"location":"api/#AtmosphericDeposition.vs-NTuple{4, Any}","page":"API","title":"AtmosphericDeposition.vs","text":"Function vs calculates the terminal setting velocity of a particle where Dp is particle diameter [m], ρₚ is particle density [kg/m3], Cc is the Cunningham slip correction factor, and μ is air dynamic viscosity [kg/(s m)].  From equation 9.42 in Seinfeld and Pandis (2006).\n\n\n\n\n\n","category":"method"},{"location":"emep/#EMEP-Wet-Deposition-Algorithm","page":"EMEP","title":"EMEP Wet Deposition Algorithm","text":"","category":"section"},{"location":"dry_deposition/#Dry-Deposition","page":"Overview","title":"Dry Deposition","text":"","category":"section"},{"location":"dry_deposition/#Model","page":"Overview","title":"Model","text":"","category":"section"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"This is an implementation of a box model used to calculate changes in gas species concentration due to dry deposition.","category":"page"},{"location":"dry_deposition/#Running-the-model","page":"Overview","title":"Running the model","text":"","category":"section"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"Here's an example of how concentration of different species, such as SO<sub>2</sub>, O<sub>3</sub>, NO<sub>2</sub>, NO, H<sub>2</sub>O<sub>2</sub> and CH<sub>2</sub>O change due to dry deposition. ","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"We can create an instance of the model in the following manner:","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"using AtmosphericDeposition\nusing ModelingToolkit\nusing DifferentialEquations\nusing EarthSciMLBase\nusing Unitful\n\n@parameters t [unit = u\"s\", description=\"Time\"]\nmodel = DrydepositionG(t)","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"Before running any simulations with the model we need to convert it into a system of differential equations.","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"sys = structural_simplify(get_mtk(model))\ntspan = (0.0, 3600*24) \nu0 = [2.0,10.0,5,5,2.34,0.15] # initial concentrations of SO₂, O₃, NO₂, NO, H₂O₂, CH₂O\nsol = solve(ODEProblem(sys, u0, tspan, []),AutoTsit5(Rosenbrock23()), saveat=10.0) # default parameters","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"which we can plot as","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"using Plots\nplot(sol, xlabel=\"Time (second)\", ylabel=\"concentration (ppb)\", legend=:outerright)","category":"page"},{"location":"dry_deposition/#Parameters","page":"Overview","title":"Parameters","text":"","category":"section"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"The parameters in the model are:","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"parameters(sys) # [z, z₀, u_star, L, ρA, G, T, θ]","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"where z is the top of the surface layer [m], z₀ is the roughness length [m], u_star is friction velocity [m/s], and L is Monin-Obukhov length [m], ρA is air density [kg/m3], T is surface air temperature [K], G is solar irradiation [W m-2], Θ is the slope of the local terrain [radians].","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"Let's run some simulation with different value for parameter z. ","category":"page"},{"location":"dry_deposition/","page":"Overview","title":"Overview","text":"@unpack O3 = sys\n\np1 = [50,0.04,0.44,0,1.2,300,298,0]\np2 = [10,0.04,0.44,0,1.2,300,298,0]\nsol1 = solve(ODEProblem(sys, u0, tspan, p1),AutoTsit5(Rosenbrock23()), saveat=10.0)\nsol2 = solve(ODEProblem(sys, u0, tspan, p2),AutoTsit5(Rosenbrock23()), saveat=10.0)\n\nplot([sol1[O3],sol2[O3]], label = [\"z=50m\" \"z=10m\"], title = \"Change of O3 concentration due to dry deposition\", xlabel=\"Time (second)\", ylabel=\"concentration (ppb)\")","category":"page"},{"location":"wesley1989/#Wesley-1989-Dry-Deposition-Surface-Resistance","page":"Wesley","title":"Wesley 1989 Dry Deposition Surface Resistance","text":"","category":"section"},{"location":"wesley1989/","page":"Wesley","title":"Wesley","text":"This is the Wesely 1989 algorithm for surface resistance to dry deposition.","category":"page"},{"location":"wesley1989/","page":"Wesley","title":"Wesley","text":"Citation for the original article, followed by citation for an article with some corrections which have been  incorporated here:","category":"page"},{"location":"wesley1989/","page":"Wesley","title":"Wesley","text":"M. L. Wesely, Parameterization of surface resistances to gaseous dry deposition in regional-scale numerical models,  Atmos. Environ. 23, 1293–1304 (1989), http:dx.doi.org/10.1016/0004-6981(89)90153-4.","category":"page"},{"location":"wesley1989/","page":"Wesley","title":"Wesley","text":"J. Walmsley, and M. L. Wesely, Modification of coded parametrizations of surface resistances to gaseous dry deposition,  Atmos. Environ. 30(7), 1181–1188 (1996), http://dx.doi.org/10.1016/1352-2310(95)00403-3.","category":"page"},{"location":"wesley1989/","page":"Wesley","title":"Wesley","text":"The abstract of the original article:","category":"page"},{"location":"wesley1989/","page":"Wesley","title":"Wesley","text":"Methods for estimating the dry deposition velocities of atmospheric gases in the U.S. and surrounding areas have been  improved and incorporated into a revised computer code module for use in numerical models  of atmospheric transport and deposition of pollutants over regional scales. The key improvement is  the computation of bulk surface resistances along three distinct pathways of mass transfer to sites of  deposition at the upper portions of vegetative canopies or structures, the lower portions, and the ground  (or water surface). This approach replaces the previous technique of providing simple look-up tables  of bulk surface resistances. With the surface resistances divided explicitly into distinct pathways,  the bulk surface resistances for a large number of gases in addition IO those usually addressed  in acid deposition models (SO2, O3, NOx, and HNO3) can be computed, if estimates of the effective Henry’s Law constants  and appropriate measures of the chemical reactiiity of the various substances are known.  This has been accomnlished successfullv for H2O2, HCHO, CH3CHO (to represent other aldehydes CH3O2H  (to represent organic peroxides), CH3C(O)O2H, HCOOH (to represent organic acids), NH3, CH3C(O)O2NO2,  and HNO2. Other factors considered include surface temperature, stomatal response to environmental parameters,  the wetting of surfaces by dew and rain, and the covering of surfaces by snow. Surface emission of gases  and variations of uptake characteristics by individual plant species within the landuse types are not considered explicitly.","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = AtmosphericDeposition","category":"page"},{"location":"#AtmosphericDeposition","page":"Home","title":"AtmosphericDeposition","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for AtmosphericDeposition.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"}]
}
