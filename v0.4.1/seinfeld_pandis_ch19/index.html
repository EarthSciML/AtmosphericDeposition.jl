<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Seinfeld &amp; Pandis Ch. 19 · AtmosphericDeposition.jl</title><meta name="title" content="Seinfeld &amp; Pandis Ch. 19 · AtmosphericDeposition.jl"/><meta property="og:title" content="Seinfeld &amp; Pandis Ch. 19 · AtmosphericDeposition.jl"/><meta property="twitter:title" content="Seinfeld &amp; Pandis Ch. 19 · AtmosphericDeposition.jl"/><meta name="description" content="Documentation for AtmosphericDeposition.jl."/><meta property="og:description" content="Documentation for AtmosphericDeposition.jl."/><meta property="twitter:description" content="Documentation for AtmosphericDeposition.jl."/><meta property="og:url" content="https://deposition.earthsci.dev/seinfeld_pandis_ch19/"/><meta property="twitter:url" content="https://deposition.earthsci.dev/seinfeld_pandis_ch19/"/><link rel="canonical" href="https://deposition.earthsci.dev/seinfeld_pandis_ch19/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">AtmosphericDeposition.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Dry Deposition</span><ul><li><a class="tocitem" href="../dry_deposition/">Overview</a></li><li><a class="tocitem" href="../wesley1989/">Wesley</a></li><li class="is-active"><a class="tocitem" href>Seinfeld &amp; Pandis Ch. 19</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li><li><a class="tocitem" href="#Package-Contents"><span>Package Contents</span></a></li><li><a class="tocitem" href="#Quick-Start"><span>Quick Start</span></a></li><li><a class="tocitem" href="#Physical-Constants"><span>Physical Constants</span></a></li><li class="toplevel"><a class="tocitem" href="#Equation-Systems"><span>Equation Systems</span></a></li><li><a class="tocitem" href="#Aerodynamic-Resistance-(Eq.-19.14)"><span>Aerodynamic Resistance (Eq. 19.14)</span></a></li><li><a class="tocitem" href="#Quasi-Laminar-Resistance-for-Gases-(Eq.-19.17)"><span>Quasi-Laminar Resistance for Gases (Eq. 19.17)</span></a></li><li><a class="tocitem" href="#Particle-Settling-(Eq.-19.18,-19.20)"><span>Particle Settling (Eq. 19.18, 19.20)</span></a></li><li><a class="tocitem" href="#Quasi-Laminar-Resistance-for-Particles-(Eq.-19.27)"><span>Quasi-Laminar Resistance for Particles (Eq. 19.27)</span></a></li><li><a class="tocitem" href="#Surface-Resistance-(Eq.-19.50-19.52)"><span>Surface Resistance (Eq. 19.50-19.52)</span></a></li><li><a class="tocitem" href="#Complete-Gas-Deposition-System-(Eq.-19.2)"><span>Complete Gas Deposition System (Eq. 19.2)</span></a></li><li><a class="tocitem" href="#Complete-Particle-Deposition-System-(Eq.-19.7)"><span>Complete Particle Deposition System (Eq. 19.7)</span></a></li><li class="toplevel"><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li><li><a class="tocitem" href="#Figure-19.2:-Particle-Deposition-Velocity-vs.-Diameter"><span>Figure 19.2: Particle Deposition Velocity vs. Diameter</span></a></li><li><a class="tocitem" href="#Collection-Efficiency-Components"><span>Collection Efficiency Components</span></a></li><li><a class="tocitem" href="#Sensitivity-to-Land-Use-Category"><span>Sensitivity to Land-Use Category</span></a></li><li><a class="tocitem" href="#Summary-Statistics"><span>Summary Statistics</span></a></li><li class="toplevel"><a class="tocitem" href="#API-Reference"><span>API Reference</span></a></li><li><a class="tocitem" href="#Module"><span>Module</span></a></li><li><a class="tocitem" href="#Physical-Constants-2"><span>Physical Constants</span></a></li><li><a class="tocitem" href="#Data-Types"><span>Data Types</span></a></li><li><a class="tocitem" href="#Component-Functions"><span>Component Functions</span></a></li></ul></li></ul></li><li><span class="tocitem">Wet Deposition</span><ul><li><a class="tocitem" href="../emep/">EMEP</a></li><li><a class="tocitem" href="../seinfeld_pandis_2006_ch20/">Seinfeld &amp; Pandis (2006) Ch. 20</a></li><li><a class="tocitem" href="../luo2023/">Luo &amp; Yu (2023)</a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Dry Deposition</a></li><li class="is-active"><a href>Seinfeld &amp; Pandis Ch. 19</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Seinfeld &amp; Pandis Ch. 19</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/main/docs/src/seinfeld_pandis_ch19.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="DryDeposition.jl"><a class="docs-heading-anchor" href="#DryDeposition.jl">DryDeposition.jl</a><a id="DryDeposition.jl-1"></a><a class="docs-heading-anchor-permalink" href="#DryDeposition.jl" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>DryDeposition.jl is a ModelingToolkit.jl implementation of the dry deposition equations from Chapter 19 of Seinfeld and Pandis (2006). Dry deposition is the transport of gaseous and particulate species from the atmosphere onto surfaces in the absence of precipitation.</p><p>The package implements the resistance model for dry deposition, which represents the deposition process using an electrical resistance analogy. The transport of material to the surface is governed by three resistances in series:</p><ul><li><strong>Aerodynamic resistance</strong> (<span>$r_a$</span>): Turbulent transport through the atmospheric surface layer</li><li><strong>Quasi-laminar resistance</strong> (<span>$r_b$</span>): Molecular/Brownian diffusion across the thin stagnant layer adjacent to the surface</li><li><strong>Surface resistance</strong> (<span>$r_c$</span>): Uptake at the surface (for gases only; particles are assumed to stick on contact)</li></ul><h3 id="Gas-Deposition"><a class="docs-heading-anchor" href="#Gas-Deposition">Gas Deposition</a><a id="Gas-Deposition-1"></a><a class="docs-heading-anchor-permalink" href="#Gas-Deposition" title="Permalink"></a></h3><p>For gases, the deposition velocity is given by:</p><p class="math-container">\[v_d = \frac{1}{r_a + r_b + r_c}\]</p><h3 id="Particle-Deposition"><a class="docs-heading-anchor" href="#Particle-Deposition">Particle Deposition</a><a id="Particle-Deposition-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Deposition" title="Permalink"></a></h3><p>For particles, gravitational settling operates in parallel with the resistance pathway:</p><p class="math-container">\[v_d = \frac{1}{r_a + r_b + r_a r_b v_s} + v_s\]</p><p>where <span>$v_s$</span> is the particle settling velocity.</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><blockquote><p>Seinfeld, J.H. and Pandis, S.N. (2006). <em>Atmospheric Chemistry and Physics: From Air Pollution to Climate Change</em>, 2nd Edition, Chapter 19: Dry Deposition. John Wiley &amp; Sons, Inc.</p></blockquote><h2 id="Package-Contents"><a class="docs-heading-anchor" href="#Package-Contents">Package Contents</a><a id="Package-Contents-1"></a><a class="docs-heading-anchor-permalink" href="#Package-Contents" title="Permalink"></a></h2><p>This package provides the following equation system implementations:</p><table><tr><th style="text-align: left">Component</th><th style="text-align: left">Equations</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.AerodynamicResistance"><code>DryDeposition.AerodynamicResistance</code></a></td><td style="text-align: left">Eq. 19.14</td><td style="text-align: left">Aerodynamic resistance for neutral stability</td></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceGas"><code>DryDeposition.QuasiLaminarResistanceGas</code></a></td><td style="text-align: left">Eq. 19.17</td><td style="text-align: left">Quasi-laminar resistance for gaseous species</td></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.ParticleSettling"><code>DryDeposition.ParticleSettling</code></a></td><td style="text-align: left">Eq. 19.18, 19.20</td><td style="text-align: left">Particle settling velocity and Brownian diffusivity</td></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceParticle"><code>DryDeposition.QuasiLaminarResistanceParticle</code></a></td><td style="text-align: left">Eq. 19.27</td><td style="text-align: left">Quasi-laminar resistance for particles (Zhang et al. 2001)</td></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.SurfaceResistance"><code>DryDeposition.SurfaceResistance</code></a></td><td style="text-align: left">Eq. 19.50-19.52</td><td style="text-align: left">Surface resistance using Wesely (1989) model</td></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.DryDepositionGas"><code>DryDeposition.DryDepositionGas</code></a></td><td style="text-align: left">Eq. 19.2</td><td style="text-align: left">Complete gas deposition velocity</td></tr><tr><td style="text-align: left"><a href="#AtmosphericDeposition.DryDeposition.DryDepositionParticle"><code>DryDeposition.DryDepositionParticle</code></a></td><td style="text-align: left">Eq. 19.7</td><td style="text-align: left">Complete particle deposition velocity</td></tr></table><h2 id="Quick-Start"><a class="docs-heading-anchor" href="#Quick-Start">Quick Start</a><a id="Quick-Start-1"></a><a class="docs-heading-anchor-permalink" href="#Quick-Start" title="Permalink"></a></h2><pre><code class="language-julia hljs">using ModelingToolkit
using ModelingToolkit: t

# Include the module
include(&quot;src/DryDeposition.jl&quot;)
using .DryDeposition

# Create a particle deposition system
@named part_dep = DryDepositionParticle()

# View system structure
unknowns(part_dep)
parameters(part_dep)
equations(part_dep)</code></pre><h2 id="Physical-Constants"><a class="docs-heading-anchor" href="#Physical-Constants">Physical Constants</a><a id="Physical-Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Constants" title="Permalink"></a></h2><p>The module uses the following physical constants:</p><table><tr><th style="text-align: left">Constant</th><th style="text-align: left">Value</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left"><span>$\kappa$</span></td><td style="text-align: left">0.4</td><td style="text-align: left">von Karman constant</td></tr><tr><td style="text-align: left"><span>$g$</span></td><td style="text-align: left">9.81 m/s^2</td><td style="text-align: left">Gravitational acceleration</td></tr><tr><td style="text-align: left"><span>$k_B$</span></td><td style="text-align: left">1.38e-23 J/K</td><td style="text-align: left">Boltzmann constant</td></tr></table><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h1 id="Equation-Systems"><a class="docs-heading-anchor" href="#Equation-Systems">Equation Systems</a><a id="Equation-Systems-1"></a><a class="docs-heading-anchor-permalink" href="#Equation-Systems" title="Permalink"></a></h1><p>This section provides detailed documentation of each equation system implemented in DryDeposition.jl, including state variables, parameters, and the governing equations.</p><h2 id="Aerodynamic-Resistance-(Eq.-19.14)"><a class="docs-heading-anchor" href="#Aerodynamic-Resistance-(Eq.-19.14)">Aerodynamic Resistance (Eq. 19.14)</a><a id="Aerodynamic-Resistance-(Eq.-19.14)-1"></a><a class="docs-heading-anchor-permalink" href="#Aerodynamic-Resistance-(Eq.-19.14)" title="Permalink"></a></h2><p>The aerodynamic resistance represents the turbulent transport of material from the bulk atmosphere down to the quasi-laminar sublayer. Under neutral stability conditions:</p><p class="math-container">\[r_a = \frac{1}{\kappa u_*} \ln\left(\frac{z}{z_0}\right)\]</p><p>where:</p><ul><li><span>$\kappa = 0.4$</span> is the von Karman constant</li><li><span>$u_*$</span> is the friction velocity (m/s)</li><li><span>$z$</span> is the reference height (m)</li><li><span>$z_0$</span> is the surface roughness length (m)</li></ul><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition
using AtmosphericDeposition.DryDeposition

@named sys = AerodynamicResistance()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">r_a</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Reference height above surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">z_0</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Surface roughness length</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">kappa</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">von Karman constant (dimensionless)</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">1-element Vector{Symbolics.Equation}:
 r_a(t) ~ log(z / z_0) / (kappa*u_star(t))</code></pre><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Quasi-Laminar-Resistance-for-Gases-(Eq.-19.17)"><a class="docs-heading-anchor" href="#Quasi-Laminar-Resistance-for-Gases-(Eq.-19.17)">Quasi-Laminar Resistance for Gases (Eq. 19.17)</a><a id="Quasi-Laminar-Resistance-for-Gases-(Eq.-19.17)-1"></a><a class="docs-heading-anchor-permalink" href="#Quasi-Laminar-Resistance-for-Gases-(Eq.-19.17)" title="Permalink"></a></h2><p>The quasi-laminar resistance for gases depends on the molecular diffusivity of the gas through the Schmidt number:</p><p class="math-container">\[r_b = \frac{5 \, \text{Sc}^{2/3}}{u_*}\]</p><p>where the Schmidt number is <span>$\text{Sc} = \nu / D_g$</span>, with <span>$\nu$</span> being the kinematic viscosity of air and <span>$D_g$</span> the molecular diffusivity of the gas.</p><h3 id="State-Variables-2"><a class="docs-heading-anchor" href="#State-Variables-2">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition
using AtmosphericDeposition.DryDeposition

@named sys = QuasiLaminarResistanceGas()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Sc</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Schmidt number (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">r_b</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Quasi-laminar resistance for gas</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr></tbody></table></div><h3 id="Parameters-2"><a class="docs-heading-anchor" href="#Parameters-2">Parameters</a><a class="docs-heading-anchor-permalink" href="#Parameters-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">nu</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Kinematic viscosity of air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">D_g</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Molecular diffusivity of gas in air</td></tr></tbody></table></div><h3 id="Equations-2"><a class="docs-heading-anchor" href="#Equations-2">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-2" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Symbolics.Equation}:
 Sc(t) ~ nu / D_g
 r_b(t) ~ (<span class="sgr34">5</span>(Sc(t)^<span class="sgr34">0.6666666666666666</span>)) / u_star(t)</code></pre><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Particle-Settling-(Eq.-19.18,-19.20)"><a class="docs-heading-anchor" href="#Particle-Settling-(Eq.-19.18,-19.20)">Particle Settling (Eq. 19.18, 19.20)</a><a id="Particle-Settling-(Eq.-19.18,-19.20)-1"></a><a class="docs-heading-anchor-permalink" href="#Particle-Settling-(Eq.-19.18,-19.20)" title="Permalink"></a></h2><p>Particle settling velocity follows Stokes&#39; law with slip correction:</p><p class="math-container">\[v_s = \frac{\rho_p D_p^2 g C_c}{18 \mu}\]</p><p>The Brownian diffusivity of particles is given by:</p><p class="math-container">\[D = \frac{k_B T C_c}{3 \pi \mu D_p}\]</p><p>where:</p><ul><li><span>$\rho_p$</span> is the particle density (kg/m^3)</li><li><span>$D_p$</span> is the particle diameter (m)</li><li><span>$g$</span> is gravitational acceleration (m/s^2)</li><li><span>$C_c$</span> is the Cunningham slip correction factor (dimensionless)</li><li><span>$\mu$</span> is the dynamic viscosity of air (Pa s)</li><li><span>$k_B$</span> is the Boltzmann constant (J/K)</li><li><span>$T$</span> is temperature (K)</li></ul><h3 id="State-Variables-3"><a class="docs-heading-anchor" href="#State-Variables-3">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition
using AtmosphericDeposition.DryDeposition

@named sys = ParticleSettling()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">v_s</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Particle settling velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">D_diff</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Brownian diffusivity of particle</td></tr></tbody></table></div><h3 id="Parameters-3"><a class="docs-heading-anchor" href="#Parameters-3">Parameters</a><a class="docs-heading-anchor-permalink" href="#Parameters-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">rho_p</td><td style = "text-align: left;">1.0 m⁻³ kg</td><td style = "text-align: left;">Particle density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">C_c</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Cunningham slip correction factor (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">g</td><td style = "text-align: left;">1.0 m s⁻²</td><td style = "text-align: left;">Gravitational acceleration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">D_p</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Particle diameter</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">mu</td><td style = "text-align: left;">1.0 m⁻¹ kg s⁻¹</td><td style = "text-align: left;">Dynamic viscosity of air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">T</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">k_B</td><td style = "text-align: left;">1.0 m² kg s⁻² K⁻¹</td><td style = "text-align: left;">Boltzmann constant</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">pi_val</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Mathematical constant pi (dimensionless)</td></tr></tbody></table></div><h3 id="Equations-3"><a class="docs-heading-anchor" href="#Equations-3">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-3" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">2-element Vector{Symbolics.Equation}:
 v_s(t) ~ (C_c*(D_p^<span class="sgr34">2</span>)*g*rho_p) / (<span class="sgr34">18</span>mu)
 D_diff(t) ~ (C_c*T*k_B) / (<span class="sgr34">3</span>D_p*mu*pi_val)</code></pre><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Quasi-Laminar-Resistance-for-Particles-(Eq.-19.27)"><a class="docs-heading-anchor" href="#Quasi-Laminar-Resistance-for-Particles-(Eq.-19.27)">Quasi-Laminar Resistance for Particles (Eq. 19.27)</a><a id="Quasi-Laminar-Resistance-for-Particles-(Eq.-19.27)-1"></a><a class="docs-heading-anchor-permalink" href="#Quasi-Laminar-Resistance-for-Particles-(Eq.-19.27)" title="Permalink"></a></h2><p>The Zhang et al. (2001) model calculates particle quasi-laminar resistance based on three collection mechanisms:</p><p class="math-container">\[r_b = \frac{1}{3 u_* (E_B + E_{IM} + E_{IN}) R_1}\]</p><p>where:</p><p><strong>Brownian diffusion efficiency</strong> (Eq. 19.21):</p><p class="math-container">\[E_B = \text{Sc}^{-\gamma}\]</p><p><strong>Impaction efficiency</strong> (Eq. 19.22):</p><p class="math-container">\[E_{IM} = \left(\frac{\text{St}}{\alpha + \text{St}}\right)^2\]</p><p><strong>Interception efficiency</strong> (Eq. 19.25):</p><p class="math-container">\[E_{IN} = \frac{1}{2}\left(\frac{D_p}{A}\right)^2\]</p><p><strong>Sticking fraction</strong> (Eq. 19.26):</p><p class="math-container">\[R_1 = \exp(-\sqrt{\text{St}})\]</p><p><strong>Stokes number for vegetated surfaces</strong> (Eq. 19.24):</p><p class="math-container">\[\text{St} = \frac{v_s u_*}{g A}\]</p><p>The parameters <span>$\alpha$</span>, <span>$\gamma$</span>, and <span>$A$</span> depend on land-use category (Table 19.2).</p><h3 id="State-Variables-4"><a class="docs-heading-anchor" href="#State-Variables-4">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-4" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition
using AtmosphericDeposition.DryDeposition

@named sys = QuasiLaminarResistanceParticle()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>10×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Sc</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Schmidt number (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">D_diff</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Brownian diffusivity of particle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">St</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Stokes number (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">v_s</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Particle settling velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">E_B</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Brownian diffusion collection efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">E_IM</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Impaction collection efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">E_IN</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Interception collection efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">R_1</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Sticking fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">r_b</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Quasi-laminar resistance for particle</td></tr></tbody></table></div><h3 id="Parameters-4"><a class="docs-heading-anchor" href="#Parameters-4">Parameters</a><a class="docs-heading-anchor-permalink" href="#Parameters-4" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">nu</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Kinematic viscosity of air</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">A</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Characteristic radius of collectors</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">g</td><td style = "text-align: left;">1.0 m s⁻²</td><td style = "text-align: left;">Gravitational acceleration</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">gamma</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Brownian diffusion efficiency parameter (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">alpha</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Impaction efficiency parameter (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">D_p</td><td style = "text-align: left;">1.0 m</td><td style = "text-align: left;">Particle diameter</td></tr></tbody></table></div><h3 id="Equations-4"><a class="docs-heading-anchor" href="#Equations-4">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-4" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">7-element Vector{Symbolics.Equation}:
 Sc(t) ~ nu / D_diff(t)
 St(t) ~ (u_star(t)*v_s(t)) / (A*g)
 E_B(t) ~ Sc(t)^(-gamma)
 E_IM(t) ~ (St(t) / (alpha + St(t)))^<span class="sgr34">2</span>
 E_IN(t) ~ <span class="sgr34">0.5</span>((D_p / A)^<span class="sgr34">2</span>)
 R_1(t) ~ exp(-sqrt(St(t)))
 r_b(t) ~ <span class="sgr34">1</span> / (<span class="sgr34">3</span>(E_B(t) + E_IN(t) + E_IM(t))*u_star(t)*R_1(t))</code></pre><h3 id="Land-Use-Parameters-(Table-19.2)"><a class="docs-heading-anchor" href="#Land-Use-Parameters-(Table-19.2)">Land-Use Parameters (Table 19.2)</a><a id="Land-Use-Parameters-(Table-19.2)-1"></a><a class="docs-heading-anchor-permalink" href="#Land-Use-Parameters-(Table-19.2)" title="Permalink"></a></h3><table><tr><th style="text-align: left">Land Use Category</th><th style="text-align: left">A (mm)</th><th style="text-align: left"><span>$\alpha$</span></th><th style="text-align: left"><span>$\gamma$</span></th></tr><tr><td style="text-align: left">Grass</td><td style="text-align: left">2.0</td><td style="text-align: left">1.2</td><td style="text-align: left">0.54</td></tr><tr><td style="text-align: left">Deciduous Forest</td><td style="text-align: left">5.0</td><td style="text-align: left">0.8</td><td style="text-align: left">0.56</td></tr><tr><td style="text-align: left">Desert</td><td style="text-align: left">10.0</td><td style="text-align: left">50.0</td><td style="text-align: left">0.54</td></tr></table><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Surface-Resistance-(Eq.-19.50-19.52)"><a class="docs-heading-anchor" href="#Surface-Resistance-(Eq.-19.50-19.52)">Surface Resistance (Eq. 19.50-19.52)</a><a id="Surface-Resistance-(Eq.-19.50-19.52)-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-Resistance-(Eq.-19.50-19.52)" title="Permalink"></a></h2><p>The Wesely (1989) model calculates surface resistance for gases using multiple parallel pathways:</p><p class="math-container">\[r_c = \left(\frac{1}{r_{st} + r_m} + \frac{1}{r_{lu}} + \frac{1}{r_{dc} + r_{cl}} + \frac{1}{r_{ac} + r_{gs}}\right)^{-1}\]</p><p><strong>Stomatal resistance</strong> (Eq. 19.51):</p><p class="math-container">\[r_{st} = r_i \left[1 + \left(\frac{200}{G + 0.1}\right)^2\right] \left[\frac{400}{T_s(40 - T_s)}\right]\]</p><p><strong>Mesophyll resistance</strong> (Eq. 19.52):</p><p class="math-container">\[r_m = \frac{1}{3.3 \times 10^{-4} H^* + 100 f_0}\]</p><p>where:</p><ul><li><span>$r_i$</span> is the minimum stomatal resistance</li><li><span>$G$</span> is solar irradiance (W/m^2)</li><li><span>$T_s$</span> is surface temperature (Celsius, valid range 0-40)</li><li><span>$H^*$</span> is the effective Henry&#39;s law constant</li><li><span>$f_0$</span> is the reactivity factor (0-1)</li></ul><h3 id="State-Variables-5"><a class="docs-heading-anchor" href="#State-Variables-5">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-5" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition
using AtmosphericDeposition.DryDeposition

@named sys = SurfaceResistance()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T_s_C</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Surface temperature offset from reference</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T_s</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">G_factor</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Irradiance factor for stomatal resistance (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">G</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Solar irradiance at surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">T_factor</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Temperature factor for stomatal resistance (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">r_st</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Stomatal resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">r_m</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Mesophyll resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">r_c</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Surface (canopy) resistance</td></tr></tbody></table></div><h3 id="Parameters-5"><a class="docs-heading-anchor" href="#Parameters-5">Parameters</a><a class="docs-heading-anchor-permalink" href="#Parameters-5" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [string(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>16×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T_ref</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Celsius to Kelvin offset</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">G_ref</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Reference irradiance for stomatal response</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">G_offset</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Small offset to prevent division by zero</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">T_coeff</td><td style = "text-align: left;">1.0 K²</td><td style = "text-align: left;">Temperature coefficient for stomatal response</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">T_max</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Maximum temperature for stomatal function</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">D_ratio</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">D_H2O/D_gas diffusivity ratio (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">r_i</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Minimum stomatal resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">H_star</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Effective Henry&apos;s law constant (dimensionless, normalized)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">H_coeff</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Henry coefficient for mesophyll</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">f_0</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Reactivity factor (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">f_coeff</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Reactivity coefficient for mesophyll</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">r_lu</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Cuticular/outer surface resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">r_ac</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">In-canopy aerodynamic resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">r_gs</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Ground surface resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">r_cl</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Lower canopy exposed surfaces resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">r_dc</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Lower canopy buoyant convection resistance</td></tr></tbody></table></div><h3 id="Equations-5"><a class="docs-heading-anchor" href="#Equations-5">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-5" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">6-element Vector{Symbolics.Equation}:
 T_s_C(t) ~ -T_ref + T_s(t)
 G_factor(t) ~ <span class="sgr34">1</span> + (G_ref / (G_offset + G(t)))^<span class="sgr34">2</span>
 T_factor(t) ~ T_coeff / ((T_max - T_s_C(t))*T_s_C(t))
 r_st(t) ~ D_ratio*r_i*T_factor(t)*G_factor(t)
 r_m(t) ~ <span class="sgr34">1</span> / (H_coeff*H_star + f_0*f_coeff)
 r_c(t) ~ <span class="sgr34">1</span> / (<span class="sgr34">1</span> / (r_ac + r_gs) + <span class="sgr34">1</span> / (r_cl + r_dc) + <span class="sgr34">1</span> / r_lu + <span class="sgr34">1</span> / (r_m(t) + r_st(t)))</code></pre><h3 id="Gas-Properties-(Table-19.4)"><a class="docs-heading-anchor" href="#Gas-Properties-(Table-19.4)">Gas Properties (Table 19.4)</a><a id="Gas-Properties-(Table-19.4)-1"></a><a class="docs-heading-anchor-permalink" href="#Gas-Properties-(Table-19.4)" title="Permalink"></a></h3><table><tr><th style="text-align: left">Species</th><th style="text-align: left"><span>$D_{H_2O}/D_{gas}$</span></th><th style="text-align: left"><span>$H^*$</span> (M/atm)</th><th style="text-align: left"><span>$f_0$</span></th></tr><tr><td style="text-align: left">SO2</td><td style="text-align: left">1.9</td><td style="text-align: left">10^5</td><td style="text-align: left">0</td></tr><tr><td style="text-align: left">O3</td><td style="text-align: left">1.6</td><td style="text-align: left">0.01</td><td style="text-align: left">1</td></tr><tr><td style="text-align: left">NO2</td><td style="text-align: left">1.6</td><td style="text-align: left">0.01</td><td style="text-align: left">0.1</td></tr><tr><td style="text-align: left">HNO3</td><td style="text-align: left">1.9</td><td style="text-align: left">10^14</td><td style="text-align: left">0</td></tr></table><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Complete-Gas-Deposition-System-(Eq.-19.2)"><a class="docs-heading-anchor" href="#Complete-Gas-Deposition-System-(Eq.-19.2)">Complete Gas Deposition System (Eq. 19.2)</a><a id="Complete-Gas-Deposition-System-(Eq.-19.2)-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Gas-Deposition-System-(Eq.-19.2)" title="Permalink"></a></h2><p>The <code>DryDepositionGas</code> component composes the aerodynamic, quasi-laminar, and surface resistance systems to calculate the complete gas deposition velocity:</p><p class="math-container">\[v_d = \frac{1}{r_a + r_b + r_c}\]</p><p>and the deposition flux (Eq. 19.1):</p><p class="math-container">\[F = -v_d C\]</p><h3 id="State-Variables-6"><a class="docs-heading-anchor" href="#State-Variables-6">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-6" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition.DryDeposition

@named sys = DryDepositionGas()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>27×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">aero₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">qlam₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">surf₊G</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Solar irradiance at surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">G</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Solar irradiance at surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">surf₊T_s</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">T_s</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">r_t</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Total resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">qlam₊r_b</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Quasi-laminar resistance for gas</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">aero₊r_a</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">surf₊r_c</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Surface (canopy) resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">v_d</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Deposition velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">F</td><td style = "text-align: left;">1.0 m⁻² s⁻¹ mol</td><td style = "text-align: left;">Deposition flux (downward positive)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">C</td><td style = "text-align: left;">1.0 m⁻³ mol</td><td style = "text-align: left;">Gas concentration at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">aero₊r_a</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">aero₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">qlam₊Sc</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Schmidt number (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">qlam₊r_b</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Quasi-laminar resistance for gas</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">qlam₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">surf₊T_s_C</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Surface temperature offset from reference</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">surf₊T_s</td><td style = "text-align: left;">1.0 K</td><td style = "text-align: left;">Surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">surf₊G_factor</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Irradiance factor for stomatal resistance (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">surf₊G</td><td style = "text-align: left;">1.0 kg s⁻³</td><td style = "text-align: left;">Solar irradiance at surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">surf₊T_factor</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Temperature factor for stomatal resistance (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">surf₊r_st</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Stomatal resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">surf₊r_m</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Mesophyll resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">surf₊r_c</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Surface (canopy) resistance</td></tr></tbody></table></div><h3 id="Equations-6"><a class="docs-heading-anchor" href="#Equations-6">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-6" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16-element Vector{Symbolics.Equation}:
 aero₊u_star(t) ~ u_star(t)
 qlam₊u_star(t) ~ u_star(t)
 surf₊G(t) ~ G(t)
 surf₊T_s(t) ~ T_s(t)
 r_t(t) ~ qlam₊r_b(t) + aero₊r_a(t) + surf₊r_c(t)
 v_d(t) ~ <span class="sgr34">1</span> / r_t(t)
 F(t) ~ -C(t)*v_d(t)
 aero₊r_a(t) ~ log(aero₊z / aero₊z_0) / (aero₊kappa*aero₊u_star(t))
 qlam₊Sc(t) ~ qlam₊nu / qlam₊D_g
 qlam₊r_b(t) ~ (<span class="sgr34">5</span>(qlam₊Sc(t)^<span class="sgr34">0.6666666666666666</span>)) / qlam₊u_star(t)
 surf₊T_s_C(t) ~ -surf₊T_ref + surf₊T_s(t)
 surf₊G_factor(t) ~ <span class="sgr34">1</span> + (surf₊G_ref / (surf₊G_offset + surf₊G(t)))^<span class="sgr34">2</span>
 surf₊T_factor(t) ~ surf₊T_coeff / ((surf₊T_max - surf₊T_s_C(t))*surf₊T_s_C(t))
 surf₊r_st(t) ~ surf₊D_ratio*surf₊r_i*surf₊G_factor(t)*surf₊T_factor(t)
 surf₊r_m(t) ~ <span class="sgr34">1</span> / (surf₊H_coeff*surf₊H_star + surf₊f_0*surf₊f_coeff)
 surf₊r_c(t) ~ <span class="sgr34">1</span> / (<span class="sgr34">1</span> / (surf₊r_ac + surf₊r_gs) + <span class="sgr34">1</span> / (surf₊r_cl + surf₊r_dc) + <span class="sgr34">1</span> / surf₊r_lu + <span class="sgr34">1</span> / (surf₊r_st(t) + surf₊r_m(t)))</code></pre><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Complete-Particle-Deposition-System-(Eq.-19.7)"><a class="docs-heading-anchor" href="#Complete-Particle-Deposition-System-(Eq.-19.7)">Complete Particle Deposition System (Eq. 19.7)</a><a id="Complete-Particle-Deposition-System-(Eq.-19.7)-1"></a><a class="docs-heading-anchor-permalink" href="#Complete-Particle-Deposition-System-(Eq.-19.7)" title="Permalink"></a></h2><p>The <code>DryDepositionParticle</code> component composes the aerodynamic, settling, and quasi-laminar resistance systems to calculate the complete particle deposition velocity:</p><p class="math-container">\[v_d = \frac{1}{r_a + r_b + r_a r_b v_s} + v_s\]</p><p>This accounts for gravitational settling operating in parallel with the turbulent/diffusive transport pathway.</p><h3 id="State-Variables-7"><a class="docs-heading-anchor" href="#State-Variables-7">State Variables</a><a class="docs-heading-anchor-permalink" href="#State-Variables-7" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using AtmosphericDeposition.DryDeposition

@named sys = DryDepositionParticle()
vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [string(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>26×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">aero₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">qlam₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">qlam₊v_s</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Particle settling velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">settling₊v_s</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Particle settling velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">qlam₊D_diff</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Brownian diffusivity of particle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">settling₊D_diff</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Brownian diffusivity of particle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">v_d</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Deposition velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">qlam₊r_b</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Quasi-laminar resistance for particle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">aero₊r_a</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">F</td><td style = "text-align: left;">1.0 m⁻² kg s⁻¹</td><td style = "text-align: left;">Deposition flux (downward positive)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">C</td><td style = "text-align: left;">1.0 m⁻³ kg</td><td style = "text-align: left;">Particle concentration at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">aero₊r_a</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">aero₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">settling₊v_s</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Particle settling velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">settling₊D_diff</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Brownian diffusivity of particle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">qlam₊Sc</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Schmidt number (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">qlam₊D_diff</td><td style = "text-align: left;">1.0 m² s⁻¹</td><td style = "text-align: left;">Brownian diffusivity of particle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">qlam₊St</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Stokes number (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">qlam₊v_s</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Particle settling velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">qlam₊u_star</td><td style = "text-align: left;">1.0 m s⁻¹</td><td style = "text-align: left;">Friction velocity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">qlam₊E_B</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Brownian diffusion collection efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">qlam₊E_IM</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Impaction collection efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">qlam₊E_IN</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Interception collection efficiency (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">qlam₊R_1</td><td style = "text-align: left;">1.0 </td><td style = "text-align: left;">Sticking fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">qlam₊r_b</td><td style = "text-align: left;">1.0 m⁻¹ s</td><td style = "text-align: left;">Quasi-laminar resistance for particle</td></tr></tbody></table></div><h3 id="Equations-7"><a class="docs-heading-anchor" href="#Equations-7">Equations</a><a class="docs-heading-anchor-permalink" href="#Equations-7" title="Permalink"></a></h3><pre><code class="language-julia hljs">equations(sys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">16-element Vector{Symbolics.Equation}:
 aero₊u_star(t) ~ u_star(t)
 qlam₊u_star(t) ~ u_star(t)
 qlam₊v_s(t) ~ settling₊v_s(t)
 qlam₊D_diff(t) ~ settling₊D_diff(t)
 v_d(t) ~ settling₊v_s(t) + <span class="sgr34">1</span> / (qlam₊r_b(t) + aero₊r_a(t) + settling₊v_s(t)*qlam₊r_b(t)*aero₊r_a(t))
 F(t) ~ -C(t)*v_d(t)
 aero₊r_a(t) ~ log(aero₊z / aero₊z_0) / (aero₊kappa*aero₊u_star(t))
 settling₊v_s(t) ~ (settling₊C_c*(settling₊D_p^<span class="sgr34">2</span>)*settling₊g*settling₊rho_p) / (<span class="sgr34">18</span>settling₊mu)
 settling₊D_diff(t) ~ (settling₊C_c*settling₊T*settling₊k_B) / (<span class="sgr34">3</span>settling₊D_p*settling₊mu*settling₊pi_val)
 qlam₊Sc(t) ~ qlam₊nu / qlam₊D_diff(t)
 qlam₊St(t) ~ (qlam₊v_s(t)*qlam₊u_star(t)) / (qlam₊A*qlam₊g)
 qlam₊E_B(t) ~ qlam₊Sc(t)^(-qlam₊gamma)
 qlam₊E_IM(t) ~ (qlam₊St(t) / (qlam₊alpha + qlam₊St(t)))^<span class="sgr34">2</span>
 qlam₊E_IN(t) ~ <span class="sgr34">0.5</span>((qlam₊D_p / qlam₊A)^<span class="sgr34">2</span>)
 qlam₊R_1(t) ~ exp(-sqrt(qlam₊St(t)))
 qlam₊r_b(t) ~ <span class="sgr34">1</span> / (<span class="sgr34">3</span>(qlam₊E_B(t) + qlam₊E_IN(t) + qlam₊E_IM(t))*qlam₊R_1(t)*qlam₊u_star(t))</code></pre><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h1 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h1><p>This section reproduces key figures from Seinfeld and Pandis (2006) Chapter 19 to validate the implementation and demonstrate the physical behavior of the dry deposition model.</p><h2 id="Figure-19.2:-Particle-Deposition-Velocity-vs.-Diameter"><a class="docs-heading-anchor" href="#Figure-19.2:-Particle-Deposition-Velocity-vs.-Diameter">Figure 19.2: Particle Deposition Velocity vs. Diameter</a><a id="Figure-19.2:-Particle-Deposition-Velocity-vs.-Diameter-1"></a><a class="docs-heading-anchor-permalink" href="#Figure-19.2:-Particle-Deposition-Velocity-vs.-Diameter" title="Permalink"></a></h2><p>Figure 19.2 (page 905) shows the characteristic V-shaped curve of particle deposition velocity as a function of particle diameter. The minimum in deposition velocity occurs in the 0.1-1.0 micrometer range, often called the &quot;accumulation mode.&quot;</p><h3 id="Physical-Explanation"><a class="docs-heading-anchor" href="#Physical-Explanation">Physical Explanation</a><a id="Physical-Explanation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Explanation" title="Permalink"></a></h3><ul><li><strong>Small particles (&lt; 0.1 micrometer)</strong>: Efficiently transported by Brownian diffusion across the quasi-laminar sublayer</li><li><strong>Intermediate particles (0.1-1.0 micrometer)</strong>: Neither Brownian diffusion nor impaction/settling is effective - the &quot;accumulation mode&quot;</li><li><strong>Large particles (&gt; 1 micrometer)</strong>: Efficiently deposited by impaction, interception, and gravitational settling</li></ul><pre><code class="language-julia hljs">using Plots

# Physical constants
const k_B = 1.38e-23  # Boltzmann constant (J/K)
const g = 9.81        # Gravitational acceleration (m/s^2)

# Air properties at 298 K
const T = 298.0       # Temperature (K)
const mu = 1.85e-5    # Dynamic viscosity (Pa*s)
const nu = 1.55e-5    # Kinematic viscosity (m^2/s)
const rho_p = 1000.0  # Particle density (kg/m^3) - unit density

# Land-use parameters for grass (Table 19.2)
const A = 2.0e-3      # Characteristic collector radius (m)
const alpha = 1.2     # Impaction parameter
const gamma_param = 0.54  # Brownian diffusion parameter

# Aerodynamic parameters
const z = 10.0        # Reference height (m)
const z_0 = 0.1       # Roughness length for grass (m)
const kappa = 0.4     # von Karman constant

&quot;&quot;&quot;
Calculate Cunningham slip correction factor.
Approximation valid for particles in air at STP.
&quot;&quot;&quot;
function cunningham_correction(D_p)
    # Mean free path of air at 298 K (m)
    lambda = 6.8e-8
    Kn = 2 * lambda / D_p  # Knudsen number
    return 1 + Kn * (1.257 + 0.4 * exp(-1.1 / Kn))
end

&quot;&quot;&quot;
Calculate particle settling velocity (Eq. 19.18).
&quot;&quot;&quot;
function settling_velocity(D_p, C_c)
    return rho_p * D_p^2 * g * C_c / (18 * mu)
end

&quot;&quot;&quot;
Calculate Brownian diffusivity (Eq. 19.20).
&quot;&quot;&quot;
function brownian_diffusivity(D_p, C_c)
    return k_B * T * C_c / (3 * pi * mu * D_p)
end

&quot;&quot;&quot;
Calculate particle deposition velocity using Zhang et al. (2001) model.
&quot;&quot;&quot;
function particle_deposition_velocity(D_p, u_star)
    # Cunningham correction
    C_c = cunningham_correction(D_p)

    # Settling velocity (Eq. 19.18)
    v_s = settling_velocity(D_p, C_c)

    # Brownian diffusivity (Eq. 19.20)
    D_diff = brownian_diffusivity(D_p, C_c)

    # Schmidt number
    Sc = nu / D_diff

    # Stokes number for vegetated surfaces (Eq. 19.24)
    St = v_s * u_star / (g * A)

    # Collection efficiencies
    E_B = Sc^(-gamma_param)                # Brownian diffusion (Eq. 19.21)
    E_IM = (St / (alpha + St))^2          # Impaction (Eq. 19.22)
    E_IN = 0.5 * (D_p / A)^2              # Interception (Eq. 19.25)

    # Sticking fraction (Eq. 19.26)
    R_1 = exp(-sqrt(St))

    # Quasi-laminar resistance (Eq. 19.27)
    r_b = 1 / (3 * u_star * (E_B + E_IM + E_IN) * R_1)

    # Aerodynamic resistance (Eq. 19.14)
    r_a = (1 / (kappa * u_star)) * log(z / z_0)

    # Particle deposition velocity (Eq. 19.7)
    v_d = 1 / (r_a + r_b + r_a * r_b * v_s) + v_s

    return v_d, v_s, E_B, E_IM, E_IN
end

# Generate data for different friction velocities (matching Figure 19.2 conditions)
D_p_range = 10 .^ range(-2, 2, length = 100) .* 1e-6  # 0.01 to 100 um

# Multiple friction velocities to show dependence
u_star_values = [0.11, 0.44, 1.17]  # m/s (from Figure 19.2 legend)
u_star_labels = [&quot;u* = 0.11 m/s (z0 = 0.002 cm)&quot;,
    &quot;u* = 0.44 m/s (z0 = 0.02 cm)&quot;,
    &quot;u* = 1.17 m/s (z0 = 0.1 cm)&quot;]

# Create the plot
p = plot(
    xlabel = &quot;Particle Diameter (micrometer)&quot;,
    ylabel = &quot;Deposition Velocity (cm/s)&quot;,
    title = &quot;Figure 19.2: Particle Dry Deposition Velocity&quot;,
    xscale = :log10,
    yscale = :log10,
    xlims = (0.01, 100),
    ylims = (0.01, 100),
    legend = :bottomright,
    size = (700, 500),
    grid = true,
    minorgrid = true
)

colors = [:blue, :red, :green]
for (i, u_star) in enumerate(u_star_values)
    v_d_values = Float64[]
    v_s_values = Float64[]

    for D_p in D_p_range
        v_d, v_s, _, _, _ = particle_deposition_velocity(D_p, u_star)
        push!(v_d_values, v_d * 100)  # Convert to cm/s
        push!(v_s_values, v_s * 100)  # Convert to cm/s
    end

    plot!(p, D_p_range .* 1e6, v_d_values,
        label = u_star_labels[i],
        linewidth = 2,
        color = colors[i])
end

# Add settling velocity line
v_s_line = [settling_velocity(D_p, cunningham_correction(D_p)) * 100 for D_p in D_p_range]
plot!(p, D_p_range .* 1e6, v_s_line,
    label = &quot;Settling velocity (v_s)&quot;,
    linewidth = 2,
    linestyle = :dash,
    color = :black)

# Add annotation for minimum region
annotate!(p, 0.3, 0.03, text(&quot;Accumulation\nMode&quot;, 8, :center))

savefig(p, &quot;figure19_2.png&quot;)
p</code></pre><img src="94e1b525.svg" alt="Example block output"/><h3 id="Interpretation"><a class="docs-heading-anchor" href="#Interpretation">Interpretation</a><a id="Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Interpretation" title="Permalink"></a></h3><p>The figure demonstrates several key features of particle dry deposition:</p><ol><li><p><strong>Minimum at 0.1-1 micrometer</strong>: The deposition velocity reaches a minimum in the accumulation mode where neither Brownian diffusion nor impaction/settling is effective.</p></li><li><p><strong>Dependence on friction velocity</strong>: Higher <span>$u_*$</span> leads to higher deposition velocities due to increased turbulent transport and impaction efficiency.</p></li><li><p><strong>Asymptotic behavior</strong>:</p><ul><li>For very small particles, <span>$v_d \propto D_p^{-2/3}$</span> due to Brownian diffusion</li><li>For very large particles, <span>$v_d \approx v_s \propto D_p^2$</span> due to gravitational settling</li></ul></li></ol><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Collection-Efficiency-Components"><a class="docs-heading-anchor" href="#Collection-Efficiency-Components">Collection Efficiency Components</a><a id="Collection-Efficiency-Components-1"></a><a class="docs-heading-anchor-permalink" href="#Collection-Efficiency-Components" title="Permalink"></a></h2><p>This figure shows the individual collection efficiency terms (Brownian diffusion, impaction, and interception) as a function of particle diameter.</p><pre><code class="language-julia hljs">using Plots

const k_B = 1.38e-23
const g = 9.81
const T = 298.0
const mu = 1.85e-5
const nu = 1.55e-5
const rho_p = 1000.0

const A = 2.0e-3
const alpha = 1.2
const gamma_param = 0.54
const u_star = 0.4

function cunningham_correction(D_p)
    lambda = 6.8e-8
    Kn = 2 * lambda / D_p
    return 1 + Kn * (1.257 + 0.4 * exp(-1.1 / Kn))
end

function collection_efficiencies(D_p)
    C_c = cunningham_correction(D_p)

    # Settling velocity
    v_s = rho_p * D_p^2 * g * C_c / (18 * mu)

    # Brownian diffusivity
    D_diff = k_B * T * C_c / (3 * pi * mu * D_p)

    # Schmidt and Stokes numbers
    Sc = nu / D_diff
    St = v_s * u_star / (g * A)

    # Collection efficiencies
    E_B = Sc^(-gamma_param)
    E_IM = (St / (alpha + St))^2
    E_IN = 0.5 * (D_p / A)^2
    R_1 = exp(-sqrt(St))

    return E_B, E_IM, E_IN, R_1
end

D_p_range = 10 .^ range(-2, 2, length = 100) .* 1e-6

E_B_vals = Float64[]
E_IM_vals = Float64[]
E_IN_vals = Float64[]
E_total_vals = Float64[]

for D_p in D_p_range
    E_B, E_IM, E_IN, R_1 = collection_efficiencies(D_p)
    push!(E_B_vals, E_B)
    push!(E_IM_vals, E_IM)
    push!(E_IN_vals, E_IN)
    push!(E_total_vals, (E_B + E_IM + E_IN) * R_1)
end

p = plot(
    xlabel = &quot;Particle Diameter (micrometer)&quot;,
    ylabel = &quot;Collection Efficiency&quot;,
    title = &quot;Collection Efficiency Components (u* = 0.4 m/s, Grass)&quot;,
    xscale = :log10,
    yscale = :log10,
    xlims = (0.01, 100),
    ylims = (1e-10, 1),
    legend = :bottomright,
    size = (700, 500),
    grid = true
)

plot!(p, D_p_range .* 1e6, E_B_vals, label = &quot;E_B (Brownian)&quot;, linewidth = 2, color = :blue)
plot!(
    p, D_p_range .* 1e6, E_IM_vals, label = &quot;E_IM (Impaction)&quot;, linewidth = 2, color = :red)
plot!(p, D_p_range .* 1e6, E_IN_vals,
    label = &quot;E_IN (Interception)&quot;, linewidth = 2, color = :green)
plot!(p, D_p_range .* 1e6, E_total_vals, label = &quot;Total (with R_1)&quot;,
    linewidth = 3, color = :black, linestyle = :dash)

savefig(p, &quot;collection_efficiencies.png&quot;)
p</code></pre><img src="aaf581c4.svg" alt="Example block output"/><h3 id="Physical-Interpretation"><a class="docs-heading-anchor" href="#Physical-Interpretation">Physical Interpretation</a><a id="Physical-Interpretation-1"></a><a class="docs-heading-anchor-permalink" href="#Physical-Interpretation" title="Permalink"></a></h3><ul><li><p><strong>Brownian diffusion (E_B)</strong>: Dominates for particles smaller than ~0.1 micrometer. Decreases as <span>$D_p^{2\gamma/3} \approx D_p^{0.36}$</span> for the Stokes-Einstein relation.</p></li><li><p><strong>Impaction (E_IM)</strong>: Becomes significant for particles larger than ~1 micrometer. Depends on the Stokes number, which increases with <span>$D_p^2$</span>.</p></li><li><p><strong>Interception (E_IN)</strong>: Also increases with particle size as <span>$D_p^2$</span>. Represents particles whose streamlines pass within one particle radius of the collector.</p></li><li><p><strong>Sticking fraction (R_1)</strong>: Reduces collection efficiency for large particles that may bounce off the surface.</p></li><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Sensitivity-to-Land-Use-Category"><a class="docs-heading-anchor" href="#Sensitivity-to-Land-Use-Category">Sensitivity to Land-Use Category</a><a id="Sensitivity-to-Land-Use-Category-1"></a><a class="docs-heading-anchor-permalink" href="#Sensitivity-to-Land-Use-Category" title="Permalink"></a></h2><p>Different land-use categories have different characteristic collector radii (A) and collection efficiency parameters, leading to variations in deposition velocity.</p><pre><code class="language-julia hljs">using Plots

const k_B = 1.38e-23
const g = 9.81
const T = 298.0
const mu = 1.85e-5
const nu = 1.55e-5
const rho_p = 1000.0
const u_star = 0.4
const z = 10.0
const kappa = 0.4

# Land-use parameters from Table 19.2
landuse_params = [
    (&quot;Grass&quot;, 2.0e-3, 1.2, 0.54, 0.1),
    (&quot;Deciduous Forest&quot;, 5.0e-3, 0.8, 0.56, 1.0),
    (&quot;Desert&quot;, 10.0e-3, 50.0, 0.54, 0.04)
]

function cunningham_correction(D_p)
    lambda = 6.8e-8
    Kn = 2 * lambda / D_p
    return 1 + Kn * (1.257 + 0.4 * exp(-1.1 / Kn))
end

function particle_v_d(D_p, A, alpha, gamma_val, z_0)
    C_c = cunningham_correction(D_p)
    v_s = rho_p * D_p^2 * g * C_c / (18 * mu)
    D_diff = k_B * T * C_c / (3 * pi * mu * D_p)

    Sc = nu / D_diff
    St = v_s * u_star / (g * A)

    E_B = Sc^(-gamma_val)
    E_IM = (St / (alpha + St))^2
    E_IN = 0.5 * (D_p / A)^2
    R_1 = exp(-sqrt(St))

    r_b = 1 / (3 * u_star * (E_B + E_IM + E_IN) * R_1)
    r_a = (1 / (kappa * u_star)) * log(z / z_0)

    v_d = 1 / (r_a + r_b + r_a * r_b * v_s) + v_s
    return v_d
end

D_p_range = 10 .^ range(-2, 2, length = 100) .* 1e-6

p = plot(
    xlabel = &quot;Particle Diameter (micrometer)&quot;,
    ylabel = &quot;Deposition Velocity (cm/s)&quot;,
    title = &quot;Particle Deposition Velocity by Land-Use Category (u* = 0.4 m/s)&quot;,
    xscale = :log10,
    yscale = :log10,
    xlims = (0.01, 100),
    ylims = (0.001, 10),
    legend = :bottomright,
    size = (700, 500),
    grid = true
)

colors = [:blue, :green, :orange]
for (i, (name, A, alpha, gamma_val, z_0)) in enumerate(landuse_params)
    v_d_vals = [particle_v_d(D_p, A, alpha, gamma_val, z_0) * 100 for D_p in D_p_range]
    plot!(p, D_p_range .* 1e6, v_d_vals, label = name, linewidth = 2, color = colors[i])
end

savefig(p, &quot;landuse_comparison.png&quot;)
p</code></pre><img src="b1737373.svg" alt="Example block output"/><ul><li><ul><li><ul><li></li></ul></li></ul></li></ul><h2 id="Summary-Statistics"><a class="docs-heading-anchor" href="#Summary-Statistics">Summary Statistics</a><a id="Summary-Statistics-1"></a><a class="docs-heading-anchor-permalink" href="#Summary-Statistics" title="Permalink"></a></h2><p>The following table summarizes typical deposition velocities from the model compared to values from Table 19.1 in the textbook.</p><pre><code class="language-julia hljs">using DataFrames

# Typical conditions
u_star = 0.4  # m/s
z = 10.0      # m
z_0 = 0.1     # m (grass)
kappa = 0.4

# Aerodynamic resistance
r_a = (1 / (kappa * u_star)) * log(z / z_0)

# Quasi-laminar resistance (Sc ~ 1 for gases)
r_b_gas = 5 * 1.0^(2/3) / u_star

# Surface resistance estimates for different gases
# Based on Table 19.1 measured values
gases = [
    (&quot;O3&quot;, 0.4, 250 - r_a - r_b_gas),
    (&quot;HNO3&quot;, 4.0, 25 - r_a - r_b_gas),
    (&quot;NO2&quot;, 0.1, 1000 - r_a - r_b_gas),
    (&quot;SO2&quot;, 0.5, 200 - r_a - r_b_gas)
]

df = DataFrame(
    Gas = [g[1] for g in gases],
    Measured_vd_cm_s = [g[2] for g in gases],
    Implied_r_c_s_m = [max(0, g[3]) for g in gases],
    r_a_s_m = fill(round(r_a, digits = 1), length(gases)),
    r_b_s_m = fill(round(r_b_gas, digits = 1), length(gases))
)
df</code></pre><div><div style = "float: left;"><span>4×5 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Gas</th><th style = "text-align: left;">Measured_vd_cm_s</th><th style = "text-align: left;">Implied_r_c_s_m</th><th style = "text-align: left;">r_a_s_m</th><th style = "text-align: left;">r_b_s_m</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th><th title = "Float64" style = "text-align: left;">Float64</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">O3</td><td style = "text-align: right;">0.4</td><td style = "text-align: right;">208.718</td><td style = "text-align: right;">28.8</td><td style = "text-align: right;">12.5</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">HNO3</td><td style = "text-align: right;">4.0</td><td style = "text-align: right;">0.0</td><td style = "text-align: right;">28.8</td><td style = "text-align: right;">12.5</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">NO2</td><td style = "text-align: right;">0.1</td><td style = "text-align: right;">958.718</td><td style = "text-align: right;">28.8</td><td style = "text-align: right;">12.5</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">SO2</td><td style = "text-align: right;">0.5</td><td style = "text-align: right;">158.718</td><td style = "text-align: right;">28.8</td><td style = "text-align: right;">12.5</td></tr></tbody></table></div><p>These results are consistent with the physical understanding that:</p><ul><li><p>HNO3 has very low surface resistance (highly soluble and reactive)</p></li><li><p>O3 has moderate surface resistance (reactive but not very soluble)</p></li><li><p>NO2 has high surface resistance</p></li><li><p>Surface resistance dominates the total resistance for most gases</p></li><li><ul><li><ul><li></li></ul></li></ul></li></ul><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><h2 id="Module"><a class="docs-heading-anchor" href="#Module">Module</a><a id="Module-1"></a><a class="docs-heading-anchor-permalink" href="#Module" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition"><code>AtmosphericDeposition.DryDeposition</code></a> — <span class="docstring-category">Module</span></summary><section><div><pre><code class="language-julia hljs">DryDeposition</code></pre><p>ModelingToolkit.jl implementation of dry deposition equations from: Seinfeld, J.H. and Pandis, S.N. (2006). Atmospheric Chemistry and Physics, 2nd Edition, Chapter 19: Dry Deposition.</p><p>This module implements:</p><ul><li>Gas deposition velocity using the resistance model (Eq. 19.2)</li><li>Particle deposition velocity (Eq. 19.7)</li><li>Aerodynamic resistance (Eq. 19.14)</li><li>Quasi-laminar resistance for gases (Eq. 19.17) and particles (Eq. 19.27)</li><li>Surface resistance using Wesely (1989) model (Eq. 19.50)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L1-L15">source</a></section></details></article><h2 id="Physical-Constants-2"><a class="docs-heading-anchor" href="#Physical-Constants-2">Physical Constants</a><a class="docs-heading-anchor-permalink" href="#Physical-Constants-2" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.KAPPA"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.KAPPA"><code>AtmosphericDeposition.DryDeposition.KAPPA</code></a> — <span class="docstring-category">Constant</span></summary><section><div><p>Physical constants used throughout the dry deposition calculations.        # von Karman constant (dimensionless)</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L31-L33">source</a></section></details></article><h2 id="Data-Types"><a class="docs-heading-anchor" href="#Data-Types">Data Types</a><a id="Data-Types-1"></a><a class="docs-heading-anchor-permalink" href="#Data-Types" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.GasProperties"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.GasProperties"><code>AtmosphericDeposition.DryDeposition.GasProperties</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Gas-specific properties from Table 19.4 for surface resistance calculations.</p><p>Fields:</p><ul><li>D<em>ratio: D</em>H2O/D_gas ratio for diffusivity</li><li>H_star: effective Henry&#39;s law constant (M/atm)</li><li>f_0: reactivity factor (0-1)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L66-L74">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.LandUseParameters"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.LandUseParameters"><code>AtmosphericDeposition.DryDeposition.LandUseParameters</code></a> — <span class="docstring-category">Type</span></summary><section><div><p>Land-use dependent parameters from Table 19.2 (Zhang et al. 2001).</p><p>Fields:</p><ul><li>A: characteristic radius of collectors (m)</li><li>alpha: parameter for impaction efficiency</li><li>gamma: parameter for Brownian diffusion efficiency</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L42-L50">source</a></section></details></article><h2 id="Component-Functions"><a class="docs-heading-anchor" href="#Component-Functions">Component Functions</a><a id="Component-Functions-1"></a><a class="docs-heading-anchor-permalink" href="#Component-Functions" title="Permalink"></a></h2><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.DryDepositionGas"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.DryDepositionGas"><code>AtmosphericDeposition.DryDeposition.DryDepositionGas</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">DryDepositionGas(; name=:DryDepositionGas)</code></pre><p>Complete gas dry deposition velocity model using resistance approach.</p><p>Implements Equation 19.2: v<em>d = 1 / (r</em>a + r<em>b + r</em>c)</p><p>and Equation 19.1 for flux: F = -v_d * C</p><p>Composes:</p><ul><li>AerodynamicResistance (Eq. 19.14)</li><li>QuasiLaminarResistanceGas (Eq. 19.17)</li><li>SurfaceResistance (Eq. 19.50-19.52)</li></ul><p>Inputs (must be specified externally):</p><ul><li>u_star: Friction velocity (m/s)</li><li>C: Gas concentration at reference height (mol/m^3)</li><li>G: Solar irradiance at surface (W/m^2) - via surf subsystem</li><li>T_s: Surface temperature (K) - via surf subsystem</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L392-L415">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.DryDepositionParticle"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.DryDepositionParticle"><code>AtmosphericDeposition.DryDeposition.DryDepositionParticle</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">DryDepositionParticle(; name=:DryDepositionParticle)</code></pre><p>Complete particle dry deposition velocity model.</p><p>Implements Equation 19.7: v<em>d = 1/(r</em>a + r<em>b + r</em>a<em>r_b</em>v<em>s) + v</em>s</p><p>and Equation 19.1 for flux: F = -v_d * C</p><p>Composes:</p><ul><li>AerodynamicResistance (Eq. 19.14)</li><li>ParticleSettling (Eq. 19.18, 19.20)</li><li>QuasiLaminarResistanceParticle (Eq. 19.27)</li></ul><p>Inputs (must be specified externally):</p><ul><li>u_star: Friction velocity (m/s)</li><li>C: Particle concentration at reference height (kg/m^3)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L457-L478">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.AerodynamicResistance"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.AerodynamicResistance"><code>AtmosphericDeposition.DryDeposition.AerodynamicResistance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AerodynamicResistance(; name=:AerodynamicResistance)</code></pre><p>Calculates aerodynamic resistance for neutral stability conditions.</p><p>Implements Equation 19.14: r<em>a = (1/(kappa * u</em>star)) * ln(z/z_0)</p><p>where:</p><ul><li>kappa = 0.4 (von Karman constant)</li><li>u_star: friction velocity (m/s)</li><li>z: reference height (m)</li><li>z_0: roughness length (m)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L91-L105">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceGas"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceGas"><code>AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceGas</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">QuasiLaminarResistanceGas(; name=:QuasiLaminarResistanceGas)</code></pre><p>Calculates quasi-laminar (boundary layer) resistance for gases.</p><p>Implements Equation 19.17: r<em>b = 5 * Sc^(2/3) / u</em>star</p><p>where Sc = nu/D_g is the Schmidt number.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L133-L142">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceParticle"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceParticle"><code>AtmosphericDeposition.DryDeposition.QuasiLaminarResistanceParticle</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">QuasiLaminarResistanceParticle(; name=:QuasiLaminarResistanceParticle)</code></pre><p>Calculates quasi-laminar resistance for particles using Zhang et al. (2001) model.</p><p>Implements Equation 19.27: r<em>b = 1 / (3 * u</em>star * (E<em>B + E</em>IM + E<em>IN) * R</em>1)</p><p>where:</p><ul><li>E_B = Sc^(-gamma) (Brownian diffusion, Eq. 19.21)</li><li>E_IM = (St/(alpha + St))^2 (impaction, Eq. 19.22 with beta=2)</li><li>E<em>IN = 0.5 * (D</em>p/A)^2 (interception, Eq. 19.25)</li><li>R_1 = exp(-sqrt(St)) (sticking fraction, Eq. 19.26)</li><li>St = v<em>s * u</em>star / (g * A) (Stokes number, Eq. 19.24)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L218-L233">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.ParticleSettling"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.ParticleSettling"><code>AtmosphericDeposition.DryDeposition.ParticleSettling</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ParticleSettling(; name=:ParticleSettling)</code></pre><p>Calculates particle settling velocity and Brownian diffusivity.</p><p>Implements:</p><ul><li><p>Equation 19.18 (Settling velocity): v<em>s = rho</em>p * D<em>p^2 * g * C</em>c / (18 * mu)</p></li><li><p>Equation 19.20 (Brownian diffusivity): D = k * T * C<em>c / (3 * pi * mu * D</em>p)</p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L169-L181">source</a></section></details></article><article><details class="docstring" open="true"><summary id="AtmosphericDeposition.DryDeposition.SurfaceResistance"><a class="docstring-binding" href="#AtmosphericDeposition.DryDeposition.SurfaceResistance"><code>AtmosphericDeposition.DryDeposition.SurfaceResistance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SurfaceResistance(; name=:SurfaceResistance)</code></pre><p>Calculates surface (canopy) resistance for gases using Wesely (1989) model.</p><p>Implements Equation 19.50: r<em>c = (1/(r</em>st + r<em>m) + 1/r</em>lu + 1/(r<em>dc + r</em>cl) + 1/(r<em>ac + r</em>gs))^(-1)</p><p>and component resistances:</p><ul><li>Eq. 19.51: Stomatal resistance r<em>st = r</em>i * [1 + (200/(G+0.1))^2] * [400/(T<em>s*(40-T</em>s))]</li><li>Eq. 19.52: Mesophyll resistance r<em>m = 1 / (3.3e-4 * H</em>star + 100 * f_0)</li></ul><p>Note: The stomatal resistance formula uses empirical coefficients with implicit units. Temperature T_s is expected in Celsius (valid range: 0-40C for the formula). Solar irradiance G is expected in W/m^2.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/AtmosphericDeposition.jl/blob/e4468c79c8dd4aae88646cd16d6bcf290874742c/src/seinfeld_pandis_ch19.jl#L292-L310">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../wesley1989/">« Wesley</a><a class="docs-footer-nextpage" href="../emep/">EMEP »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Saturday 28 February 2026 12:44">Saturday 28 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
